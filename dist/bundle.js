!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=35)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{static getDocumentWidth(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)}static getDocumentHeight(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)}static getMainCanvas(){return document.querySelector("#draw")}static getPreviewCanvas(){return document.querySelector("#preview")}static getMainDiv(){return document.querySelector("#main")}static getWaveformDiv(){return document.querySelector("#waveform")}static getEditorDiv(){return document.querySelector("#editor")}static getEditForm(){return document.forms.namedItem("edit")}static getLoadForm(){return document.forms.namedItem("load")}static getAvailableMaxWidthForMainDiv(){return.95*(this.getDocumentWidth()-this.getMainDivMarginLeft()-this.getEditorDivWidthInPx())}static getAvailableMaxHeightForMainDiv(){return this.getDocumentHeight()-60}static getEditorDivWidthInPx(){const e=this.getEditorDiv().style.width.replace("%","").replace("px","");return"0"==e||""==e?0:this.getDocumentWidth()*parseInt(e)/100+20}static getMainDivMarginLeft(){return Number(this.getMainDiv().style.marginLeft.replace("px",""))}static setHTMLInputElementValue(e,t){document.getElementById(e).value=""+t}static getPlayPauseButton(){return document.querySelector("[data-action='play']")}static getCCButton(){return document.querySelector("#cc")}static getWaveformZoomSlider(){return document.querySelector("[data-action='zoom']")}static getExportButton(){return document.querySelector("[data-action='export']")}static getToggleEditorButton(){return document.getElementById("toggle_editor_button")}static openEditor(){this.getToggleEditorButton().textContent="🖉 Close Editor",n.getEditorDiv().style.width="40%",n.getEditorDiv().style.borderLeft="1px solid black",n.getEditorDiv().style.paddingLeft="10px",n.getEditorDiv().style.paddingRight="10px"}static closeEditor(){this.getToggleEditorButton().textContent="🖉 Open Editor",n.getEditorDiv().style.width="0",n.getEditorDiv().style.borderLeft="",n.getEditorDiv().style.paddingLeft="0",n.getEditorDiv().style.paddingRight="0"}static removeLoadModalDialog(){document.getElementById("load_modal_dialog").remove()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScope=t.Scope=t.Name=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const n=r(22),i=r(29);var s=r(22);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return s._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return s.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return s.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return s.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return s.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return s.stringify}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return s.Name}});var a=r(29);Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return a.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return a.ValueScope}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return a.varKinds}}),t.operators={GT:new n._Code(">"),GTE:new n._Code(">="),LT:new n._Code("<"),LTE:new n._Code("<="),EQ:new n._Code("==="),NEQ:new n._Code("!=="),NOT:new n._Code("!"),OR:new n._Code("||"),AND:new n._Code("&&")};class o{optimizeNodes(){return this}optimizeNames(e,t){return this}}class c extends o{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const r=e?i.varKinds.var:this.varKind,n=void 0===this.rhs?"":" = "+this.rhs;return`${r} ${this.name}${n};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=O(this.rhs,e,t)),this}get names(){return this.rhs instanceof n._CodeOrName?this.rhs.names:{}}}class u extends o{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof n.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=O(this.rhs,e,t),this}get names(){return R(this.lhs instanceof n.Name?{}:{...this.lhs.names},this.rhs)}}class l extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return this.label+":"+e}}class d extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?" "+this.label:""};`+e}}class h extends o{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class f extends o{constructor(e){super(),this.code=e}render({_n:e}){return this.code+";"+e}optimizeNodes(){return""+this.code?this:void 0}optimizeNames(e,t){return this.code=O(this.code,e,t),this}get names(){return this.code instanceof n._CodeOrName?this.code.names:{}}}class p extends o{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const i=r[n];i.optimizeNames(e,t)||(j(e,i.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>x(e,t.names),{})}}class m extends p{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class v extends p{}class g extends m{}g.kind="else";class y extends m{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new g(e):e}return t?!1===e?t instanceof y?t:t.nodes:this.nodes.length?this:new y(T(e),t instanceof y?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=O(this.condition,e,t),this}get names(){const e=super.names;return R(e,this.condition),this.else&&x(e,this.else.names),e}}y.kind="if";class w extends m{}w.kind="for";class b extends w{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=O(this.iteration,e,t),this}get names(){return x(super.names,this.iteration.names)}}class _ extends w{constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?i.varKinds.var:this.varKind,{name:r,from:n,to:s}=this;return`for(${t} ${r}=${n}; ${r}<${s}; ${r}++)`+super.render(e)}get names(){const e=R(super.names,this.from);return R(e,this.to)}}class E extends w{constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=O(this.iterable,e,t),this}get names(){return x(super.names,this.iterable.names)}}class k extends m{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}k.kind="func";class P extends p{render(e){return"return "+super.render(e)}}P.kind="return";class $ extends m{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&x(e,this.catch.names),this.finally&&x(e,this.finally.names),e}}class C extends m{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}C.kind="catch";class S extends m{render(e){return"finally"+super.render(e)}}S.kind="finally";function x(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function R(e,t){return t instanceof n._CodeOrName?x(e,t.names):e}function O(e,t,r){return e instanceof n.Name?s(e):(i=e)instanceof n._Code&&i._items.some(e=>e instanceof n.Name&&1===t[e.str]&&void 0!==r[e.str])?new n._Code(e._items.reduce((e,t)=>(t instanceof n.Name&&(t=s(t)),t instanceof n._Code?e.push(...t._items):e.push(t),e),[])):e;var i;function s(e){const n=r[e.str];return void 0===n||1!==t[e.str]?e:(delete t[e.str],n)}}function j(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function T(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:n._`!${A(e)}`}t.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new i.Scope({parent:e}),this._nodes=[new v]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const i=this._scope.toName(t);return void 0!==r&&n&&(this._constants[i.str]=r),this._leafNode(new c(e,i,r)),i}const(e,t,r){return this._def(i.varKinds.const,e,t,r)}let(e,t,r){return this._def(i.varKinds.let,e,t,r)}var(e,t,r){return this._def(i.varKinds.var,e,t,r)}assign(e,t,r){return this._leafNode(new u(e,t,r))}code(e){return"function"==typeof e?e():e!==n.nil&&this._leafNode(new f(e)),this}object(...e){const t=["{"];for(const[r,i]of e)t.length>1&&t.push(","),t.push(r),(r!==i||this.opts.es5)&&(t.push(":"),n.addCodeArg(t,i));return t.push("}"),new n._Code(t)}if(e,t,r){if(this._blockNode(new y(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new y(e))}else(){return this._elseNode(new g)}endIf(){return this._endBlockNode(y,g)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new b(e),t)}forRange(e,t,r,n,s=(this.opts.es5?i.varKinds.var:i.varKinds.let)){const a=this._scope.toName(e);return this._for(new _(s,a,t,r),()=>n(a))}forOf(e,t,r,s=i.varKinds.const){const a=this._scope.toName(e);if(this.opts.es5){const e=t instanceof n.Name?t:this.var("_arr",t);return this.forRange("_i",0,n._`${e}.length`,t=>{this.var(a,n._`${e}[${t}]`),r(a)})}return this._for(new E("of",s,a,t),()=>r(a))}forIn(e,t,r,s=(this.opts.es5?i.varKinds.var:i.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,n._`Object.keys(${t})`,r);const a=this._scope.toName(e);return this._for(new E("in",s,a,t),()=>r(a))}endFor(){return this._endBlockNode(w)}label(e){return this._leafNode(new l(e))}break(e){return this._leafNode(new d(e))}return(e){const t=new P;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(P)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new $;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new C(e),t(e)}return r&&(this._currNode=n.finally=new S,this.code(r)),this._endBlockNode(C,S)}throw(e){return this._leafNode(new h(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=n.nil,r,i){return this._blockNode(new k(e,t,r)),i&&this.code(i).endFunc(),this}endFunc(){return this._endBlockNode(k)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},t.not=T;const I=M(t.operators.AND);t.and=function(...e){return e.reduce(I)};const N=M(t.operators.OR);function M(e){return(t,r)=>t===n.nil?r:r===n.nil?t:n._`${A(t)} ${e} ${A(r)}`}function A(e){return e instanceof n.Name?e:n._`(${e})`}t.or=function(...e){return e.reduce(N)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));class n{constructor(e,t,r){this.canvas=e,this.type=t,this.options=r}do(e){throw new Error("Not implemented")}execute(){this.do(this.canvas.mainContext)}preview(){this.do(this.canvas.previewContext)}}class i{}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const n=r(1),i=r(4);function s(e,t=e.schema){const{opts:r,self:n}=e;if(!r.strict)return;if("boolean"==typeof t)return;const s=n.RULES.keywords;for(const r in t)s[r]||i.checkStrictMode(e,`unknown keyword: "${r}"`)}function a(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function o(e){return"number"==typeof e?""+e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function c(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function u({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:i}){return(s,a,o,c)=>{const u=void 0===o?a:o instanceof n.Name?(a instanceof n.Name?e(s,a,o):t(s,a,o),o):a instanceof n.Name?(t(s,o,a),a):r(a,o);return c!==n.Name||u instanceof n.Name?u:i(s,u)}}function l(e,t){if(!0===t)return e.var("props",!0);const r=e.var("props",n._`{}`);return void 0!==t&&d(e,r,t),r}function d(e,t,r){Object.keys(r).forEach(r=>e.assign(n._`${t}${n.getProperty(r)}`,!0))}t.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(s(e,t),!a(t,e.self.RULES.all))},t.checkUnknownRules=s,t.schemaHasRules=a,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},t.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,i,s){if(!s){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return n._`${r}`}return n._`${e}${t}${n.getProperty(i)}`},t.unescapeFragment=function(e){return c(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(o(e))},t.escapeJsonPointer=o,t.unescapeJsonPointer=c,t.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},t.mergeEvaluated={props:u({mergeNames:(e,t,r)=>e.if(n._`${r} !== true && ${t} !== undefined`,()=>{e.if(n._`${t} === true`,()=>e.assign(r,!0),()=>e.code(n._`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if(n._`${r} !== true`,()=>{!0===t?e.assign(r,!0):(e.assign(r,n._`${r} || {}`),d(e,r,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:l}),items:u({mergeNames:(e,t,r)=>e.if(n._`${r} !== true && ${t} !== undefined`,()=>e.assign(r,n._`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if(n._`${r} !== true`,()=>e.assign(r,!0===t||n._`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=l,t.setEvaluated=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.schemaCxtHasRules=t.subschemaCode=t.validateFunctionCode=void 0;const n=r(36),i=r(9),s=r(37),a=r(1),o=r(6),c=r(20),u=r(3);function l({gen:e,validateName:t,schema:r,schemaEnv:n,opts:i},s){i.code.es5?e.func(t,a._`${o.default.data}, ${o.default.valCxt}`,n.$async,()=>{e.code(a._`"use strict"; ${d(r,i)}`),function(e,t){e.if(o.default.valCxt,()=>{e.var(o.default.dataPath,a._`${o.default.valCxt}.${o.default.dataPath}`),e.var(o.default.parentData,a._`${o.default.valCxt}.${o.default.parentData}`),e.var(o.default.parentDataProperty,a._`${o.default.valCxt}.${o.default.parentDataProperty}`),e.var(o.default.rootData,a._`${o.default.valCxt}.${o.default.rootData}`),t.dynamicRef&&e.var(o.default.dynamicAnchors,a._`${o.default.valCxt}.${o.default.dynamicAnchors}`)},()=>{e.var(o.default.dataPath,a._`""`),e.var(o.default.parentData,a._`undefined`),e.var(o.default.parentDataProperty,a._`undefined`),e.var(o.default.rootData,o.default.data),t.dynamicRef&&e.var(o.default.dynamicAnchors,a._`{}`)})}(e,i),e.code(s)}):e.func(t,a._`${o.default.data}, ${function(e){return a._`{${o.default.dataPath}="", ${o.default.parentData}, ${o.default.parentDataProperty}, ${o.default.rootData}=${o.default.data}${e.dynamicRef?a._`, ${o.default.dynamicAnchors}={}`:a.nil}}={}`}(i)}`,n.$async,()=>e.code(d(r,i)).code(s))}function d(e,t){return"object"==typeof e&&e.$id&&(t.code.source||t.code.process)?a._`/*# sourceURL=${e.$id} */`:a.nil}function h({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function f(e){return"boolean"!=typeof e.schema}function p(e){u.checkUnknownRules(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:i}=e;t.$ref&&n.ignoreKeywordsWithRef&&u.schemaHasRulesButRef(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function m(e,t){const r=i.getSchemaTypes(e.schema),n=i.coerceAndCheckDataType(e,r);s.schemaKeywords(e,r,!n,t)}function v({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:i}){const s=r.$comment;if(!0===i.$comment)e.code(a._`${o.default.self}.logger.log(${s})`);else if("function"==typeof i.$comment){const r=a.str`${n}/$comment`,i=e.scopeValue("root",{ref:t.root});e.code(a._`${o.default.self}.opts.$comment(${s}, ${r}, ${i}.schema)`)}}function g(e,t,r=e.opts.strict){if(r){if(t="strict mode: "+t,!0===r)throw new Error(t);e.self.logger.warn(t)}}t.validateFunctionCode=function(e){f(e)&&(p(e),h(e))?function(e){const{schema:t,opts:r,gen:n}=e;l(e,()=>{r.$comment&&t.$comment&&v(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strict&&g(e,"default is ignored in the schema root")}(e),n.let(o.default.vErrors,null),n.let(o.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",a._`${r}.evaluated`),t.if(a._`${e.evaluated}.dynamicProps`,()=>t.assign(a._`${e.evaluated}.props`,a._`undefined`)),t.if(a._`${e.evaluated}.dynamicItems`,()=>t.assign(a._`${e.evaluated}.items`,a._`undefined`))}(e),m(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:i,opts:s}=e;r.$async?t.if(a._`${o.default.errors} === 0`,()=>t.return(o.default.data),()=>t.throw(a._`new ${i}(${o.default.vErrors})`)):(t.assign(a._`${n}.errors`,o.default.vErrors),s.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof a.Name&&e.assign(a._`${t}.props`,r);n instanceof a.Name&&e.assign(a._`${t}.items`,n)}(e),t.return(a._`${o.default.errors} === 0`))}(e)})}(e):l(e,()=>n.topBoolOrEmptySchema(e))},t.subschemaCode=function(e,t){f(e)&&(p(e),h(e))?function(e,t){const{schema:r,gen:n,opts:i}=e;i.$comment&&r.$comment&&v(e);(function(e){e.schema.$id&&(e.baseId=c.resolveUrl(e.baseId,e.schema.$id))})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const s=n.const("_errs",o.default.errors);m(e,s),n.var(t,a._`${s} === ${o.default.errors}`)}(e,t):n.boolOrEmptySchema(e,t)},t.schemaCxtHasRules=h,t.checkStrictMode=g},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n){super(),this.topLeftX=e,this.topLeftY=t,this.bottomRightX=r,this.bottomRightY=n}}class s extends n.a{constructor(e,t){super(e,"zoom",t)}do(e){this.canvas.render(this.options.topLeftX,this.options.topLeftY,this.options.bottomRightX,this.options.bottomRightY)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i={data:new n.Name("data"),valCxt:new n.Name("valCxt"),dataPath:new n.Name("dataPath"),parentData:new n.Name("parentData"),parentDataProperty:new n.Name("parentDataProperty"),rootData:new n.Name("rootData"),dynamicAnchors:new n.Name("dynamicAnchors"),vErrors:new n.Name("vErrors"),errors:new n.Name("errors"),this:new n.Name("this"),self:new n.Name("self"),scope:new n.Name("scope")};t.default=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};class i{static localFileContentsToBase64String(e){return n(this,void 0,void 0,(function*(){return fetch(e).then(e=>e.arrayBuffer()).then(e=>btoa(function(e){const t=[];for(let r=0;r<e.length;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return t.join("")}(new Uint8Array(e))))}))}static localFileContentsToString(e){return n(this,void 0,void 0,(function*(){return fetch(e).then(e=>e.text())}))}static localFileContentsToBlob(e){return n(this,void 0,void 0,(function*(){return fetch(e).then(e=>e.blob())}))}static saveBlobToFile(e,t){const r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(r)},0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const n=r(1),i=r(3),s=r(6);function a(e,t){return n._`Object.prototype.hasOwnProperty.call(${e}, ${t})`}function o(e,t,r){const i=n._`${e}${n.getProperty(t)} === undefined`;return r?n._`${i} || !${a(e,t)}`:i}function c(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}t.checkReportMissingProp=function(e,t){const{gen:r,data:i,it:s}=e;r.if(o(i,t,s.opts.ownProperties),()=>{e.setParams({missingProperty:n._`${t}`},!0),e.error()})},t.checkMissingProp=function({data:e,it:{opts:t}},r,i){return n.or(...r.map(r=>n._`${o(e,r,t.ownProperties)} && (${i} = ${r})`))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.propertyInData=function(e,t,r){const i=n._`${e}${n.getProperty(t)} !== undefined`;return r?n._`${i} && ${a(e,t)}`:i},t.noPropertyInData=o,t.allSchemaProperties=c,t.schemaProperties=function(e,t){return c(t).filter(r=>!i.alwaysValidSchema(e,t[r]))},t.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:i,schemaPath:a,errorPath:o},it:c},u,l,d){const h=d?n._`${e}, ${t}, ${i}${a}`:t,f=[[s.default.dataPath,n.strConcat(s.default.dataPath,o)],[s.default.parentData,c.parentData],[s.default.parentDataProperty,c.parentDataProperty],[s.default.rootData,s.default.rootData]];c.opts.dynamicRef&&f.push([s.default.dynamicAnchors,s.default.dynamicAnchors]);const p=n._`${h}, ${r.object(...f)}`;return l!==n.nil?n._`${u}.call(${l}, ${p})`:n._`${u}(${p})`},t.usePattern=function(e,t){return e.scopeValue("pattern",{key:t,ref:new RegExp(t,"u"),code:n._`new RegExp(${t}, "u")`})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const n=r(27),i=r(28),s=r(19),a=r(1),o=r(3);var c;function u(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(n.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(c=t.DataType||(t.DataType={})),t.getSchemaTypes=function(e){const t=u(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=u,t.coerceAndCheckDataType=function(e,t){const{gen:r,data:n,opts:s}=e,o=function(e,t){return t?e.filter(e=>l.has(e)||"array"===t&&"array"===e):[]}(t,s.coerceTypes),u=t.length>0&&!(0===o.length&&1===t.length&&i.schemaHasRulesForType(e,t[0]));if(u){const i=h(t,n,s.strict,c.Wrong);r.if(i,()=>{o.length?function(e,t,r){const{gen:n,data:i,opts:s}=e,o=n.let("dataType",a._`typeof ${i}`),c=n.let("coerced",a._`undefined`);"array"===s.coerceTypes&&n.if(a._`${o} == 'object' && Array.isArray(${i}) && ${i}.length == 1`,()=>n.assign(i,a._`${i}[0]`).assign(o,a._`typeof ${i}`).if(h(t,i,s.strict),()=>n.assign(c,i)));n.if(a._`${c} !== undefined`);for(const e of r)(l.has(e)||"array"===e&&"array"===s.coerceTypes)&&u(e);function u(e){switch(e){case"string":return void n.elseIf(a._`${o} == "number" || ${o} == "boolean"`).assign(c,a._`"" + ${i}`).elseIf(a._`${i} === null`).assign(c,a._`""`);case"number":return void n.elseIf(a._`${o} == "boolean" || ${i} === null
              || (${o} == "string" && ${i} && ${i} == +${i})`).assign(c,a._`+${i}`);case"integer":return void n.elseIf(a._`${o} === "boolean" || ${i} === null
              || (${o} === "string" && ${i} && ${i} == +${i} && !(${i} % 1))`).assign(c,a._`+${i}`);case"boolean":return void n.elseIf(a._`${i} === "false" || ${i} === 0 || ${i} === null`).assign(c,!1).elseIf(a._`${i} === "true" || ${i} === 1`).assign(c,!0);case"null":return n.elseIf(a._`${i} === "" || ${i} === 0 || ${i} === false`),void n.assign(c,null);case"array":n.elseIf(a._`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${i} === null`).assign(c,a._`[${i}]`)}}n.else(),p(e),n.endIf(),n.if(a._`${c} !== undefined`,()=>{n.assign(i,c),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(a._`${t} !== undefined`,()=>e.assign(a._`${t}[${r}]`,n))}(e,c)})}(e,t,o):p(e)})}return u};const l=new Set(["string","number","integer","boolean","null"]);function d(e,t,r,n=c.Correct){const i=n===c.Correct?a.operators.EQ:a.operators.NEQ;let s;switch(e){case"null":return a._`${t} ${i} null`;case"array":s=a._`Array.isArray(${t})`;break;case"object":s=a._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":s=o(a._`!(${t} % 1) && !isNaN(${t})`);break;case"number":s=o();break;default:return a._`typeof ${t} ${i} ${e}`}return n===c.Correct?s:a.not(s);function o(e=a.nil){return a.and(a._`typeof ${t} == "number"`,e,r?a._`isFinite(${t})`:a.nil)}}function h(e,t,r,n){if(1===e.length)return d(e[0],t,r,n);let i;const s=o.toHash(e);if(s.array&&s.object){const e=a._`typeof ${t} != "object"`;i=s.null?e:a._`!${t} || ${e}`,delete s.null,delete s.array,delete s.object}else i=a.nil;s.number&&delete s.integer;for(const e in s)i=a.and(i,d(e,t,r,n));return i}t.checkDataType=d,t.checkDataTypes=h;const f={message:({schema:e})=>a.str`should be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?a._`{type: ${e}}`:a._`{type: ${t}}`};function p(e){const t=function(e){const{gen:t,data:r,schema:n}=e,i=o.schemaRefOrVal(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:i,schemaValue:i,parentSchema:n,params:{},it:e}}(e);s.reportError(t,f)}t.reportTypeError=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applySubschema=t.Type=void 0;const n=r(4),i=r(3),s=r(1);var a;!function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(a=t.Type||(t.Type={})),t.applySubschema=function(e,t,r){const o=function(e,{keyword:t,schemaProp:r,schema:n,strictSchema:a,schemaPath:o,errSchemaPath:c,topSchemaRef:u}){if(void 0!==t&&void 0!==n)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const n=e.schema[t];return void 0===r?{schema:n,schemaPath:s._`${e.schemaPath}${s.getProperty(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:n[r],schemaPath:s._`${e.schemaPath}${s.getProperty(t)}${s.getProperty(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${i.escapeFragment(r)}`}}if(void 0!==n){if(void 0===o||void 0===c||void 0===u)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,strictSchema:a,schemaPath:o,topSchemaRef:u,errSchemaPath:c}}throw new Error('either "keyword" or "schema" must be passed')}(e,t);!function(e,t,{dataProp:r,dataPropType:n,data:o,dataTypes:c,propertyName:u}){if(void 0!==o&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:l}=t;if(void 0!==r){const{errorPath:o,dataPathArr:c,opts:u}=t;d(l.let("data",s._`${t.data}${s.getProperty(r)}`,!0)),e.errorPath=s.str`${o}${function(e,t,r){if(e instanceof s.Name){const n=t===a.Num;return r?n?s._`"[" + ${e} + "]"`:s._`"['" + ${e} + "']"`:n?s._`"/" + ${e}`:s._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?s.getProperty(e).toString():"/"+i.escapeJsonPointer(e)}(r,n,u.jsPropertySyntax)}`,e.parentDataProperty=s._`${r}`,e.dataPathArr=[...c,e.parentDataProperty]}if(void 0!==o){d(o instanceof s.Name?o:l.let("data",o,!0)),void 0!==u&&(e.propertyName=u)}c&&(e.dataTypes=c);function d(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],e.parentData=t.data,e.dataNames=[...t.dataNames,r]}}(o,e,t),function(e,{compositeRule:t,createErrors:r,allErrors:n,strictSchema:i}){void 0!==t&&(e.compositeRule=t);void 0!==r&&(e.createErrors=r);void 0!==n&&(e.allErrors=n);e.strictSchema=i}(o,t);const c={...e,...o,items:void 0,props:void 0};return n.subschemaCode(c,r),c}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n,i,s){super(),this.topLeftX=e,this.topLeftY=t,this.bottomRightX=r,this.bottomRightY=n,this.borderSize=i,this.color=s}}class s extends n.a{constructor(e,t){super(e,"draw_rectangle",t)}do(e){const t=this.canvas.getPointProjectionOnCanvas(this.options.topLeftX,this.options.topLeftY),r=t.x,n=t.y,i=this.canvas.getPointProjectionOnCanvas(this.options.bottomRightX,this.options.bottomRightY),s=i.x-r,a=i.y-n;e.save(),e.beginPath(),e.lineWidth=this.options.borderSize,e.strokeStyle=this.options.color,e.rect(r,n,s,a),e.stroke(),e.restore()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n,i){super(),this.centerX=e,this.centerY=t,this.radius=r,this.borderSize=n,this.color=i}}class s extends n.a{constructor(e,t){super(e,"draw_circle",t)}do(e){const t=this.canvas.getPointProjectionOnCanvas(this.options.centerX,this.options.centerY),r=t.x,n=t.y,i=this.canvas.getImageRatio(),s=this.options.radius/i.ratioWidth,a=this.options.radius/i.ratioHeight;e.save(),e.beginPath(),e.lineWidth=this.options.borderSize,e.strokeStyle=this.options.color,e.arc(r,n,s,0,Math.PI),e.stroke(),e.beginPath(),e.arc(r,n,a,Math.PI,2*Math.PI),e.stroke(),e.restore()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n,i){super(),this.centerX=e,this.centerY=t,this.radius=r,this.lineWidth=n,this.color=i}}class s extends n.a{constructor(e,t){super(e,"draw_xcross",t)}do(e){const t=this.canvas.getPointProjectionOnCanvas(this.options.centerX,this.options.centerY),r=t.x,n=t.y,i=this.canvas.getImageRatio(),s=this.options.radius/i.ratioWidth,a=this.options.radius/i.ratioHeight;e.save(),e.translate(r,n),e.rotate(Math.PI/4),e.translate(-r,-n),e.lineWidth=this.options.lineWidth,e.strokeStyle=this.options.color,e.beginPath(),e.moveTo(r-s,n),e.lineTo(r+s,n),e.stroke(),e.moveTo(r,n-a),e.lineTo(r,n+a),e.stroke(),e.restore()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n,i,s,a){super(),this.text=e,this.position=t,this.backgroundColor=r,this.backgroundColorOpacity=n,this.textColor=i,this.fontSize=s,this.font=a}}class s extends n.a{constructor(e,t){super(e,"subtitle",t)}do(e){if(this.canvas.ccEnabled){const t=this.canvas.getWidthAndHeight(),r=t.width/2,n=10,i=10;e.save(),e.font=this.options.fontSize+"px "+this.options.font,e.textAlign="center",e.textBaseline="bottom";const s=this.options.text.split(new RegExp("\\r?\\n|\\r"));let a=0;s.forEach(t=>{const r=e.measureText(t),n=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent+2*i;a+=n});let o=Math.max(Math.min(t.height*this.options.position/100-a/2,t.height-a),0);s.forEach(s=>{const a=e.measureText(s),c=a.width+2*n,u=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent+2*i,l=r-Math.abs(a.actualBoundingBoxLeft)-n;o+=u;const d=o-a.actualBoundingBoxAscent-i;e.fillStyle=this.options.backgroundColor,e.globalAlpha=this.options.backgroundColorOpacity/100,e.fillRect(l,d,c,u),e.globalAlpha=1,e.fillStyle=this.options.textColor,e.fillText(s,r,o,t.width)}),e.restore()}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r(2);class i extends n.a{constructor(e,t){super(e,"focus_rectangle",t)}do(e){const t=this.canvas.getPointProjectionOnCanvas(this.options.topLeftX,this.options.topLeftY),r=t.x,n=t.y,i=this.canvas.getPointProjectionOnCanvas(this.options.bottomRightX,this.options.bottomRightY),s=i.x,a=i.y,o=this.canvas.getPointProjectionOnCanvas(this.canvas.imgTopLeftX,this.canvas.imgTopLeftY),c=this.canvas.getPointProjectionOnCanvas(this.canvas.imgBottomRightX,this.canvas.imgBottomRightY);e.save(),e.globalAlpha=.75,e.filter="blur(4px)";const u=new Path2D;u.moveTo(o.x,o.y),u.lineTo(c.x,o.y),u.lineTo(c.x,c.y),u.lineTo(o.x,c.y),u.moveTo(o.x,o.y),u.lineTo(r,n),u.lineTo(s,n),u.lineTo(s,a),u.lineTo(r,a),u.lineTo(r,n),u.closePath(),e.fill(u,"evenodd"),e.restore()}}class s extends n.b{constructor(e,t,r,n){super(),this.topLeftX=e,this.topLeftY=t,this.bottomRightX=r,this.bottomRightY=n}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n){super(),this.centerX=e,this.centerY=t,this.radius=r,this.color=n}}class s extends n.a{constructor(e,t){super(e,"draw_point",t)}do(e){const t=this.canvas.getPointProjectionOnCanvas(this.options.centerX,this.options.centerY),r=t.x,n=t.y,i=this.canvas.getImageRatio(),s=this.options.radius/i.ratioWidth,a=this.options.radius/i.ratioHeight;e.save(),e.beginPath(),e.fillStyle=this.options.color,e.strokeStyle=this.options.color,e.arc(r,n,s,0,Math.PI),e.fill(),e.beginPath(),e.arc(r,n,a,Math.PI,2*Math.PI),e.fill(),e.restore()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(2);class i extends n.b{constructor(e,t,r,n,i,s){super(),this.originX=e,this.originY=t,this.destinationX=r,this.destinationY=n,this.lineWidth=i,this.color=s}}class s extends n.a{constructor(e,t){super(e,"draw_arrow",t)}do(e){const t=this.canvas.getPointProjectionOnCanvas(this.options.originX,this.options.originY),r=t.x,n=t.y,i=this.canvas.getPointProjectionOnCanvas(this.options.destinationX,this.options.destinationY),s=i.x,a=i.y;e.save(),e.lineWidth=this.options.lineWidth,e.strokeStyle=this.options.color,e.beginPath(),e.moveTo(r,n),e.lineTo(s,a),e.stroke(),e.closePath(),e.beginPath();const o=2*this.options.lineWidth;let c=Math.atan2(a-n,s-r);e.moveTo(o*Math.cos(c)+s,o*Math.sin(c)+a),c+=1/3*(2*Math.PI),e.lineTo(o*Math.cos(c)+s,o*Math.sin(c)+a),c+=1/3*(2*Math.PI),e.lineTo(o*Math.cos(c)+s,o*Math.sin(c)+a),e.closePath(),e.fill(),e.restore()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=void 0;const n=r(9),i=r(3),s=r(19),a=r(1),o=r(6),c=r(10);t.default=class{constructor(e,t,r){if(function({schema:e,opts:t,self:r},n,i){if(Array.isArray(n.keyword)?!n.keyword.includes(i):n.keyword!==i)throw new Error("ajv implementation error");const s=n.dependencies;if(null==s?void 0:s.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${i}: ${s.join(",")}`);if(n.validateSchema){if(!n.validateSchema(e[i])){const e="keyword value is invalid: "+r.errorsText(n.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}}(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=i.schemaRefOrVal(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",d(this.$data,e));else if(this.schemaCode=this.schemaValue,!function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e)}(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",o.default.errors))}result(e,t,r){this.gen.if(a.not(e)),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.result(e,void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(a._`${t} !== undefined && (${a.or(this.invalid$data(),e)})`)}error(e){(e?s.reportExtraError:s.reportError)(this,this.def.error||s.keywordError)}$dataError(){s.reportError(this,this.def.$dataError||s.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');s.resetErrorsCount(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=a.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=a.nil,t=a.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:i,def:s}=this;r.if(a.or(a._`${n} === undefined`,t)),e!==a.nil&&r.assign(e,!0),(i.length||s.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==a.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:i,it:s}=this;return a.or(function(){if(r.length){if(!(t instanceof a.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return a._`${n.checkDataTypes(e,t,s.opts.strict,n.DataType.Wrong)}`}return a.nil}(),function(){if(i.validateSchema){const r=e.scopeValue("validate$data",{ref:i.validateSchema});return a._`!${r}(${t})`}return a.nil}())}subschema(e,t){return c.applySubschema(this.it,e,t)}mergeEvaluated(e,t){const{it:r,gen:n}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=i.mergeEvaluated.props(n,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=i.mergeEvaluated.items(n,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,()=>this.mergeEvaluated(e,a.Name)),!0}};const u=/^\/(?:[^~]|~0|~1)*$/,l=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function d(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let s,c;if(""===e)return o.default.rootData;if("/"===e[0]){if(!u.test(e))throw new Error("Invalid JSON-pointer: "+e);s=e,c=o.default.rootData}else{const i=l.exec(e);if(!i)throw new Error("Invalid JSON-pointer: "+e);const a=+i[1];if(s=i[2],"#"===s){if(a>=t)throw new Error(f("property/index",a));return n[t-a]}if(a>t)throw new Error(f("data",a));if(c=r[t-a],!s)return c}let d=c;const h=s.split("/");for(const e of h)e&&(c=a._`${c}${a.getProperty(i.unescapeJsonPointer(e))}`,d=a._`${d} && ${c}`);return d;function f(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}t.getData=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const n=r(1),i=r(6);function s(e,t){const r=e.const("err",t);e.if(n._`${i.default.vErrors} === null`,()=>e.assign(i.default.vErrors,n._`[${r}]`),n._`${i.default.vErrors}.push(${r})`),e.code(n._`${i.default.errors}++`)}function a(e,t){const{gen:r,validateName:i,schemaEnv:s}=e;s.$async?r.throw(n._`new ${e.ValidationError}(${t})`):(r.assign(n._`${i}.errors`,t),r.return(!1))}t.keywordError={message:({keyword:e})=>n.str`should pass "${e}" keyword validation`},t.keyword$DataError={message:({keyword:e,schemaType:t})=>t?n.str`"${e}" keyword must be ${t} ($data)`:n.str`"${e}" keyword is invalid ($data)`},t.reportError=function(e,t,r){const{it:i}=e,{gen:o,compositeRule:u,allErrors:l}=i,d=c(e,t);(null!=r?r:u||l)?s(o,d):a(i,n._`[${d}]`)},t.reportExtraError=function(e,t){const{it:r}=e,{gen:n,compositeRule:o,allErrors:u}=r;s(n,c(e,t)),o||u||a(r,i.default.vErrors)},t.resetErrorsCount=function(e,t){e.assign(i.default.errors,t),e.if(n._`${i.default.vErrors} !== null`,()=>e.if(t,()=>e.assign(n._`${i.default.vErrors}.length`,t),()=>e.assign(i.default.vErrors,null)))},t.extendErrors=function({gen:e,keyword:t,schemaValue:r,data:s,errsCount:a,it:o}){if(void 0===a)throw new Error("ajv implementation error");const c=e.name("err");e.forRange("i",a,i.default.errors,a=>{e.const(c,n._`${i.default.vErrors}[${a}]`),e.if(n._`${c}.dataPath === undefined`,()=>e.assign(n._`${c}.dataPath`,n.strConcat(i.default.dataPath,o.errorPath))),e.assign(n._`${c}.schemaPath`,n.str`${o.errSchemaPath}/${t}`),o.opts.verbose&&(e.assign(n._`${c}.schema`,r),e.assign(n._`${c}.data`,s))})};const o={keyword:new n.Name("keyword"),schemaPath:new n.Name("schemaPath"),params:new n.Name("params"),propertyName:new n.Name("propertyName"),message:new n.Name("message"),schema:new n.Name("schema"),parentSchema:new n.Name("parentSchema")};function c(e,t){const{keyword:r,data:s,schemaValue:a,it:{gen:c,createErrors:u,topSchemaRef:l,schemaPath:d,errorPath:h,errSchemaPath:f,propertyName:p,opts:m}}=e;if(!1===u)return n._`{}`;const{params:v,message:g}=t,y=[[o.keyword,r],[i.default.dataPath,n.strConcat(i.default.dataPath,h)],[o.schemaPath,n.str`${f}/${r}`],[o.params,"function"==typeof v?v(e):v||n._`{}`]];if(p&&y.push([o.propertyName,p]),!1!==m.messages){const t="function"==typeof g?g(e):g;y.push([o.message,t])}return m.verbose&&y.push([o.schema,a],[o.parentSchema,n._`${l}${d}`],[i.default.data,s]),c.object(...y)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const n=r(3),i=r(21),s=r(40),a=r(30),o=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!u(e):!!t&&function e(t){let r=0;for(const i in t){if("$ref"===i)return 1/0;if(r++,!o.has(i)&&("object"==typeof t[i]&&n.eachItem(t[i],t=>r+=e(t)),r===1/0))return 1/0}return r}(e)<=t)};const c=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function u(e){for(const t in e){if(c.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(u))return!0;if("object"==typeof r&&u(r))return!0}return!1}function l(e="",t){!1!==t&&(e=f(e));return d(a.parse(e))}function d(e){return a.serialize(e).split("#")[0]+"#"}t.getFullPath=l,t._getFullPath=d;const h=/#\/?$/;function f(e){return e?e.replace(h,""):""}t.normalizeId=f,t.resolveUrl=function(e,t){return t=f(t),a.resolve(e,t)};const p=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e){if("boolean"==typeof e)return{};const t=f(e.$id),r={"":t},n=l(t,!1),o={},c=new Set;return s(e,{allKeys:!0},(e,t,i,s)=>{if(void 0===s)return;const l=n+t;let h=r[s];function m(t){if(t=f(h?a.resolve(h,t):t),c.has(t))throw d(t);c.add(t);let r=this.refs[t];return"string"==typeof r&&(r=this.refs[r]),"object"==typeof r?u(e,r.schema,t):t!==f(l)&&("#"===t[0]?(u(e,o[t],t),o[t]=e):this.refs[t]=l),t}function v(e){if("string"==typeof e){if(!p.test(e))throw new Error(`invalid anchor "${e}"`);m.call(this,"#"+e)}}"string"==typeof e.$id&&(h=m.call(this,e.$id)),v.call(this,e.$anchor),v.call(this,e.$dynamicAnchor),r[t]=h}),o;function u(e,t,r){if(void 0!==t&&!i(e,t))throw d(r)}function d(e){return new Error(`reference "${e}" resolves to more than one schema`)}}},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;0!=i--;){var a=s[i];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class n{}t._CodeOrName=n,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class i extends n{constructor(e){if(super(),!t.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=i;class s extends n{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof i&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function a(e,...t){const r=[e[0]];let n=0;for(;n<t.length;)u(r,t[n]),r.push(e[++n]);return new s(r)}t._Code=s,t.nil=new s(""),t._=a;const o=new s("+");function c(e,...t){const r=[d(e[0])];let n=0;for(;n<t.length;)r.push(o),u(r,t[n]),r.push(o,d(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===o){const r=l(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new s(r)}function u(e,t){var r;t instanceof s?e.push(...t._items):t instanceof i?e.push(t):e.push("number"==typeof(r=t)||"boolean"==typeof r||null===r?r:d(Array.isArray(r)?r.join(","):r))}function l(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof i||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof i?void 0:`"${e}${t.slice(1)}`}function d(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.str=c,t.addCodeArg=u,t.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:c`${e}${t}`},t.stringify=function(e){return new s(d(e))},t.safeStringify=d,t.getProperty=function(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new s("."+e):a`[${e}]`}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=void 0;const n=r(20);class i extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}t.ValidationError=i;class s extends Error{constructor(e,t){super(`can't resolve reference ${t} from id ${e}`),this.missingRef=n.resolveUrl(e,t),this.missingSchema=n.normalizeId(n.getFullPath(this.missingRef))}}t.MissingRefError=s,e.exports={ValidationError:i,MissingRefError:s}},function(e,t,r){"use strict";r.r(t),r.d(t,"Canvas",(function(){return s}));var n=r(5),i=r(0);class s{constructor(e){this.img=new Image,this.img.src=e,this.img.addEventListener("load",()=>{this.renderImage()}),this.imgTopLeftX=0,this.imgTopLeftY=0,this.imgBottomRightX=this.img.naturalWidth,this.imgBottomRightY=this.img.naturalHeight,this.mainCanvas=i.a.getMainCanvas(),this.mainContext=this.mainCanvas.getContext("2d"),this.previewCanvas=i.a.getPreviewCanvas(),this.previewContext=this.previewCanvas.getContext("2d"),this.clickPosition={x:0,y:0},this.ccEnabled=!1}render(e,t,r,n){this.imgTopLeftX=e,this.imgTopLeftY=t,this.imgBottomRightX=r,this.imgBottomRightY=n;const s=this.imgBottomRightX-this.imgTopLeftX,a=this.imgBottomRightY-this.imgTopLeftY,o=s/a,c=i.a.getAvailableMaxWidthForMainDiv(),u=i.a.getAvailableMaxHeightForMainDiv();let l=Math.min(c,s),d=l/o;d>=u&&(d=u,l=d*o),this.mainCanvas.width=l,this.mainCanvas.height=d,this.mainContext.drawImage(this.img,this.imgTopLeftX,this.imgTopLeftY,s,a,0,0,l,d),this.previewCanvas.width=l,this.previewCanvas.height=d,this.previewCanvas.style.display="none"}renderFullImage(){this.render(0,0,this.img.naturalWidth,this.img.naturalHeight)}renderImage(){this.render(this.imgTopLeftX,this.imgTopLeftY,this.imgBottomRightX,this.imgBottomRightY)}getWidthAndHeight(){return{width:this.mainCanvas.width,height:this.mainCanvas.height}}getImageRatio(){const e=this.imgBottomRightX-this.imgTopLeftX,t=this.imgBottomRightY-this.imgTopLeftY,r=this.getWidthAndHeight();return{ratioWidth:e/r.width,ratioHeight:t/r.height}}getPointProjectionOnCanvas(e,t){const r=this.getImageRatio();return{x:(e-this.imgTopLeftX)/r.ratioWidth,y:(t-this.imgTopLeftY)/r.ratioHeight}}getCursorPositionOnCanvas(e){const t=this.mainCanvas.getBoundingClientRect(),r=e.clientX-t.left,n=e.clientY-t.top,i=this.getImageRatio();return{x:Math.floor(r*i.ratioWidth)+this.imgTopLeftX,y:Math.floor(n*i.ratioHeight)+this.imgTopLeftY}}addClickEventListener(e){this.mainCanvas.addEventListener("click",e)}executeAction(e){e.execute()}executeActions(e){null==e.find(e=>e instanceof n.a)&&this.renderFullImage(),this.renderImage(),e.forEach(e=>{this.executeAction(e)})}previewAction(e,t){this.previewCanvas.style.display="block",e.preview(),setTimeout(()=>{if(this.previewContext.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.previewCanvas.style.display="none",e instanceof n.a){const e=new n.a(this,new n.b(0,0,this.img.naturalWidth,this.img.naturalHeight));this.executeAction(e)}},t)}}},function(e,t,r){"use strict";r.r(t),r.d(t,"App",(function(){return P}));class n{constructor(e){this.loadForm=e}getExamplesSpans(){return document.querySelector("#examples").getElementsByTagName("span")}getOkButton(){return this.loadForm.elements.namedItem("load_ok")}getImageInput(){return this.loadForm.elements.namedItem("image")}getAudioInput(){return this.loadForm.elements.namedItem("audio")}getActionsInput(){return this.loadForm.elements.namedItem("actions")}displayLoadErrorMessage(e){document.getElementById("loading_text").innerHTML=e}}class i{constructor(e,t,r){this.imageData=e,this.audioBlob=t,this.jsonActions=r}}class s extends Error{constructor(e){super(e)}}var a=r(7),o=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};class c{constructor(e){this.loadForm=e}load(){return o(this,void 0,void 0,(function*(){const e=this.loadForm.getImageInput(),t=this.loadForm.getAudioInput(),r=this.loadForm.getActionsInput(),n=new Promise(t=>{if(1!=e.files.length)throw new s("No image selected");{const r=new FileReader;r.readAsDataURL(e.files[0]),r.onloadend=()=>t(r.result)}}),o=new Promise(e=>{if(1!=t.files.length)throw new s("No audio selected");{const r=new FileReader;r.readAsArrayBuffer(t.files[0]),r.onloadend=()=>{e(new Blob([new Uint8Array(r.result)]))}}}),c=new Promise(e=>{if(1==r.files.length){const t=new FileReader;t.readAsDataURL(r.files[0]),t.onloadend=()=>{a.a.localFileContentsToString("./assets/actions_json_schema.json").then(r=>{const n=JSON.parse(decodeURIComponent(escape(atob(t.result.split(",")[1])))),i=new Ajv,a=JSON.parse(r);if(!i.addSchema(a,"schema").validate("schema",n))throw new s("Invalid JSON : "+JSON.stringify(i.errors,null,2));e(n)})}}else e(JSON.parse("[]"))});return new i(yield n,yield o,yield c)}))}}var u=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};class l{constructor(e){switch(e){case"🇫🇷":this.localRelativePathToImage="./examples/language_learning/krashen_spock.png",this.localRelativePathToAudio="./examples/language_learning/fr/krashen_spock.wav",this.localRelativePathToActions="./examples/language_learning/fr/krashen_spock.json";break;case"🇩🇪":this.localRelativePathToImage="./examples/language_learning/krashen_spock.png",this.localRelativePathToAudio="./examples/language_learning/de/krashen_spock.wav",this.localRelativePathToActions="./examples/language_learning/de/krashen_spock.json";break;case"👨‍💻":this.localRelativePathToImage="./examples/it_architecture/data_lake_on_gcp.png",this.localRelativePathToAudio="./examples/it_architecture/data_lake_on_gcp.wav",this.localRelativePathToActions="./examples/it_architecture/data_lake_on_gcp.json";break;default:throw new Error("Unknown example")}}load(){return u(this,void 0,void 0,(function*(){const e=yield a.a.localFileContentsToBase64String(this.localRelativePathToImage),t=yield a.a.localFileContentsToBlob(this.localRelativePathToAudio),r=yield a.a.localFileContentsToString(this.localRelativePathToActions),n=this.localRelativePathToImage.split("."),s=n[n.length-1];return new i("data:image/"+s+";base64,"+e,t,JSON.parse(r))}))}}var d=r(26),h=r(24);class f{constructor(e){this.editForm=e}setOnSubmit(e){this.editForm.onsubmit=e}setOnReset(e){this.editForm.onreset=e}getFormInputElement(e){return this.editForm.elements.namedItem(e)}getActions(){return this.editForm.elements.namedItem("action_type")}getRegionStartInput(){return this.getFormInputElement("start")}getRegionEndInput(){return this.getFormInputElement("end")}getRegionNoteInput(){return this.getFormInputElement("note")}getFormSelectElement(e){return this.editForm.elements.namedItem(e)}getFormButtonElement(e){return this.editForm.elements.namedItem(e)}getAllDivs(){return this.editForm.querySelectorAll("div")}getDeleteRegionButton(){return this.editForm.elements.namedItem("delete_region")}displayAndReturnActionDiv(e){const t="action_"+e;let r;return this.getAllDivs().forEach((function(e){if(null!=e.attributes.name){const n=e.attributes.name.value;t==n?(e.style.opacity="1",e.style.display="block",r=e):(e.style.opacity="0",e.style.display="none")}})),r}show(){this.editForm.style.height="55%"}hide(){this.editForm.style.height="0"}reset(){this.editForm.reset()}}var p=r(11),m=r(12),v=r(13),g=r(5),y=r(14),w=r(15),b=r(0),_=r(16),E=r(17);class k{constructor(e,t){this.editAction=e=>{if(this.getRegionStartInput().value=""+Math.round(100*(e.start+Number.EPSILON))/100,this.getRegionEndInput().value=""+Math.round(100*(e.end+Number.EPSILON))/100,null!=e.data.note?this.editForm.getRegionNoteInput().value=""+e.data.note:this.editForm.getRegionNoteInput().value="",0!==Object.keys(e.data).length||e.data.constructor!==Object){const t=e.data;switch(t.action.type){case"draw_arrow":this.getFormInputElement("action_type").value="draw_arrow",this.getFormInputElement("draw_arrow_originX").value=t.action.options.originX,this.getFormInputElement("draw_arrow_originY").value=t.action.options.originY,this.getFormInputElement("draw_arrow_destinationX").value=t.action.options.destinationX,this.getFormInputElement("draw_arrow_destinationY").value=t.action.options.destinationY,this.getFormInputElement("draw_arrow_lineWidth").value=t.action.options.lineWidth,this.getFormInputElement("draw_arrow_color").value=t.action.options.color;break;case"draw_circle":this.getFormInputElement("action_type").value="draw_circle",this.getFormInputElement("draw_circle_centerX").value=t.action.options.centerX,this.getFormInputElement("draw_circle_centerY").value=t.action.options.centerY,this.getFormInputElement("draw_circle_radius").value=t.action.options.radius,this.getFormInputElement("draw_circle_borderSize").value=t.action.options.borderSize,this.getFormInputElement("draw_circle_color").value=t.action.options.color;break;case"draw_rectangle":this.getFormInputElement("action_type").value="draw_rectangle",this.getFormInputElement("draw_rectangle_topLeftX").value=t.action.options.topLeftX,this.getFormInputElement("draw_rectangle_topLeftY").value=t.action.options.topLeftY,this.getFormInputElement("draw_rectangle_bottomRightX").value=t.action.options.bottomRightX,this.getFormInputElement("draw_rectangle_bottomRightY").value=t.action.options.bottomRightY,this.getFormInputElement("draw_rectangle_borderSize").value=t.action.options.borderSize,this.getFormInputElement("draw_rectangle_color").value=t.action.options.color;break;case"draw_point":this.getFormInputElement("action_type").value="draw_point",this.getFormInputElement("draw_point_centerX").value=t.action.options.centerX,this.getFormInputElement("draw_point_centerY").value=t.action.options.centerY,this.getFormInputElement("draw_point_radius").value=t.action.options.radius,this.getFormInputElement("draw_point_color").value=t.action.options.color;break;case"draw_xcross":this.getFormInputElement("action_type").value="draw_xcross",this.getFormInputElement("draw_xcross_centerX").value=t.action.options.centerX,this.getFormInputElement("draw_xcross_centerY").value=t.action.options.centerY,this.getFormInputElement("draw_xcross_radius").value=t.action.options.radius,this.getFormInputElement("draw_xcross_color").value=t.action.options.color;break;case"zoom":this.getFormInputElement("action_type").value="zoom",this.getFormInputElement("zoom_topLeftX").value=t.action.options.topLeftX,this.getFormInputElement("zoom_topLeftY").value=t.action.options.topLeftY,this.getFormInputElement("zoom_bottomRightX").value=t.action.options.bottomRightX,this.getFormInputElement("zoom_bottomRightY").value=t.action.options.bottomRightY;break;case"subtitle":this.getFormInputElement("action_type").value="subtitle",this.getFormInputElement("subtitle_text").value=t.action.options.text,this.getFormInputElement("subtitle_position").value=t.action.options.position,this.getFormInputElement("subtitle_backgroundColor").value=t.action.options.backgroundColor,this.getFormInputElement("subtitle_textColor").value=t.action.options.textColor;break;case"focus_rectangle":this.getFormInputElement("action_type").value="focus_rectangle",this.getFormInputElement("focus_rectangle_topLeftX").value=t.action.options.topLeftX,this.getFormInputElement("focus_rectangle_topLeftY").value=t.action.options.topLeftY,this.getFormInputElement("focus_rectangle_bottomRightX").value=t.action.options.bottomRightX,this.getFormInputElement("focus_rectangle_bottomRightY").value=t.action.options.bottomRightY;break;default:this.getFormInputElement("action_type").value="default"}}else this.getFormInputElement("action_type").value="draw_point";this.getActions().forEach(e=>{e.checked&&e.dispatchEvent(new Event("click"))}),this.editForm.show(),this.editForm.setOnSubmit(t=>{t.preventDefault();const r=this.getFormInputElement("action_type").value;let n;n=this.getActionFromActionType(r),e.update({start:this.editForm.getRegionStartInput().value,end:this.editForm.getRegionEndInput().value,data:{action:n,note:this.editForm.getRegionNoteInput().value}}),this.editForm.reset()}),this.editForm.setOnReset(()=>{this.editForm.hide(),this.currentActionDiv=void 0})},this.editForm=e,this.getActions().forEach(e=>{e.addEventListener("click",()=>{const t=e.value;this.displayActionDiv(t)})}),this.getFormButtonElement("action_preview").addEventListener("click",e=>{this.preview(e)}),this.canvas=t,this.canvas.addClickEventListener(e=>this.clickOnCanvas(e))}getFormInputElement(e){return this.editForm.getFormInputElement(e)}getFormButtonElement(e){return this.editForm.getFormButtonElement(e)}getActions(){return this.editForm.getActions()}getRegionStartInput(){return this.editForm.getRegionStartInput()}getRegionEndInput(){return this.editForm.getRegionEndInput()}getActionFromActionType(e){let t;switch(e){case"draw_arrow":t=new E.a(this.canvas,new E.b(Number(this.getFormInputElement("draw_arrow_originX").value),Number(this.getFormInputElement("draw_arrow_originY").value),Number(this.getFormInputElement("draw_arrow_destinationX").value),Number(this.getFormInputElement("draw_arrow_destinationY").value),Number(this.getFormInputElement("draw_arrow_lineWidth").value),this.getFormInputElement("draw_arrow_color").value));break;case"draw_circle":t=new m.a(this.canvas,new m.b(Number(this.getFormInputElement("draw_circle_centerX").value),Number(this.getFormInputElement("draw_circle_centerY").value),Number(this.getFormInputElement("draw_circle_radius").value),Number(this.getFormInputElement("draw_circle_borderSize").value),this.getFormInputElement("draw_circle_color").value));break;case"draw_point":t=new _.a(this.canvas,new _.b(Number(this.getFormInputElement("draw_point_centerX").value),Number(this.getFormInputElement("draw_point_centerY").value),Number(this.getFormInputElement("draw_point_radius").value),this.getFormInputElement("draw_point_color").value));break;case"draw_rectangle":t=new p.a(this.canvas,new p.b(Number(this.getFormInputElement("draw_rectangle_topLeftX").value),Number(this.getFormInputElement("draw_rectangle_topLeftY").value),Number(this.getFormInputElement("draw_rectangle_bottomRightX").value),Number(this.getFormInputElement("draw_rectangle_bottomRightY").value),Number(this.getFormInputElement("draw_rectangle_borderSize").value),this.getFormInputElement("draw_rectangle_color").value));break;case"draw_xcross":t=new v.a(this.canvas,new v.b(Number(this.getFormInputElement("draw_xcross_centerX").value),Number(this.getFormInputElement("draw_xcross_centerY").value),Number(this.getFormInputElement("draw_xcross_radius").value),Number(this.getFormInputElement("draw_xcross_lineWidth").value),this.getFormInputElement("draw_xcross_color").value));break;case"zoom":t=new g.a(this.canvas,new g.b(Number(this.getFormInputElement("zoom_topLeftX").value),Number(this.getFormInputElement("zoom_topLeftY").value),Number(this.getFormInputElement("zoom_bottomRightX").value),Number(this.getFormInputElement("zoom_bottomRightY").value)));break;case"subtitle":t=new y.a(this.canvas,new y.b(this.getFormInputElement("subtitle_text").value,Number(this.getFormInputElement("subtitle_position").value),this.getFormInputElement("subtitle_backgroundColor").value,Number(this.getFormInputElement("subtitle_backgroundColorOpacity").value),this.getFormInputElement("subtitle_textColor").value,Number(this.getFormInputElement("subtitle_fontSize").value),"Roboto Medium"));break;case"focus_rectangle":t=new w.a(this.canvas,new w.b(Number(this.getFormInputElement("focus_rectangle_topLeftX").value),Number(this.getFormInputElement("focus_rectangle_topLeftY").value),Number(this.getFormInputElement("focus_rectangle_bottomRightX").value),Number(this.getFormInputElement("focus_rectangle_bottomRightY").value)));break;default:throw new Error("Invalid action type : "+e)}return t}displayActionDiv(e){this.currentActionDiv=this.editForm.displayAndReturnActionDiv(e)}resetActionDiv(){this.currentActionDiv=void 0}preview(e){let t;e.preventDefault(),this.editForm.getAllDivs().forEach(e=>{if(e.id.startsWith("action_")&&"none"!=e.style.display){const r=e.id.substr(7);t=this.getActionFromActionType(r)}});const r=this.getFormButtonElement("action_preview");r.disabled=!0;this.canvas.previewAction(t,2e3),setTimeout((function(){r.disabled=!1}),2e3)}clickOnCanvas(e){const t=this.canvas.getCursorPositionOnCanvas(e),r=t.x,n=t.y;if(null!=this.currentActionDiv){const e=this.currentActionDiv.id,t=e.substr(7);let i=document.querySelector("div#"+e+" input[type=radio]:checked");if(null!=i)switch(e){case"action_draw_arrow":i.id=="set_"+t+"_origin"?(b.a.setHTMLInputElementValue(t+"_originX",r),b.a.setHTMLInputElementValue(t+"_originY",n)):i.id=="set_"+t+"_destination"&&(b.a.setHTMLInputElementValue(t+"_destinationX",r),b.a.setHTMLInputElementValue(t+"_destinationY",n));break;case"action_draw_circle":case"action_draw_point":i.id=="set_"+t+"_center"&&(b.a.setHTMLInputElementValue(t+"_centerX",r),b.a.setHTMLInputElementValue(t+"_centerY",n));break;case"action_draw_rectangle":i.id=="set_"+t+"_topLeft"?(b.a.setHTMLInputElementValue(t+"_topLeftX",r),b.a.setHTMLInputElementValue(t+"_topLeftY",n)):i.id=="set_"+t+"_bottomRight"&&(b.a.setHTMLInputElementValue(t+"_bottomRightX",r),b.a.setHTMLInputElementValue(t+"_bottomRightY",n));break;case"action_draw_xcross":i.id=="set_"+t+"_center"&&(b.a.setHTMLInputElementValue(t+"_centerX",r),b.a.setHTMLInputElementValue(t+"_centerY",n));break;case"action_zoom":i.id=="set_"+t+"_topLeft"?(b.a.setHTMLInputElementValue(t+"_topLeftX",r),b.a.setHTMLInputElementValue(t+"_topLeftY",n)):i.id=="set_"+t+"_bottomRight"&&(b.a.setHTMLInputElementValue(t+"_bottomRightX",r),b.a.setHTMLInputElementValue(t+"_bottomRightY",n));break;case"action_subtitle":break;case"action_focus_rectangle":i.id=="set_"+t+"_topLeft"?(b.a.setHTMLInputElementValue(t+"_topLeftX",r),b.a.setHTMLInputElementValue(t+"_topLeftY",n)):i.id=="set_"+t+"_bottomRight"&&(b.a.setHTMLInputElementValue(t+"_bottomRightX",r),b.a.setHTMLInputElementValue(t+"_bottomRightY",n));break;default:throw new Error("Invalid action : ["+e+"]")}}}}class P{run(){const e=new n(b.a.getLoadForm());e.getOkButton().addEventListener("click",()=>{new c(e).load().then(e=>{this.init(e)}).catch(t=>{t instanceof s?e.displayLoadErrorMessage(t.message):console.log(t)})});const t=e.getExamplesSpans();for(let e=0;e<t.length;e++){const r=t[e];r.addEventListener("click",()=>{new l(r.innerText).load().then(e=>{this.init(e)})})}}init(e){const t=e.imageData,r=e.audioBlob,n=e.jsonActions,i=new h.Canvas(t),s=new k(new f(b.a.getEditForm()),i);new d.CustomWaveSurfer(r,n,i,s),b.a.removeLoadModalDialog(),b.a.getToggleEditorButton().addEventListener("click",()=>{const e=b.a.getEditorDiv().style.width;"0px"==e||""==e?b.a.openEditor():b.a.closeEditor(),i.renderImage()});const a=b.a.getCCButton();a.addEventListener("click",()=>{i.ccEnabled=!i.ccEnabled,i.ccEnabled?a.src="assets/images/cc.png":a.src="assets/images/nocc.png"}),window.addEventListener("resize",()=>{i.renderImage()})}}},function(e,t,r){"use strict";r.r(t),r.d(t,"CustomWaveSurfer",(function(){return _}));var n=r(11),i=r(12),s=r(13),a=r(5),o=r(14),c=r(15),u=r(7);class l{static isEquivalent(e,t){if(typeof e!=typeof t)return!1;const r=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t);if(r.length!=n.length)return!1;for(let n=0;n<r.length;n++){const i=r[n];if(e[i]!==t[i])return!1}return!0}}var d=r(0),h=r(16),f=r(17),p=r(33),m=r.n(p);class v{constructor(e,t){this.wavesurfer=t,this.wrapper=t.drawer.wrapper,this.util=t.util,this.style=this.util.style,this.id=null==e.id?t.util.getId():e.id,this.start=Number(e.start)||0,this.end=null==e.end?this.start+4/this.wrapper.scrollWidth*this.wavesurfer.getDuration():Number(e.end),this.resize=void 0===e.resize||Boolean(e.resize),this.drag=void 0===e.drag||Boolean(e.drag),this.isResizing=!1,this.isDragging=!1,this.loop=Boolean(e.loop),this.color=e.color||"rgba(0, 0, 0, 0.1)",this.handleStyle=e.handleStyle||{left:{backgroundColor:"rgba(0, 0, 0, 1)"},right:{backgroundColor:"rgba(0, 0, 0, 1)"}},this.data=e.data||{},this.attributes=e.attributes||{},this.maxLength=e.maxLength,this.minLength=e.minLength,this._onRedraw=()=>this.updateRender(),this.scroll=!1!==e.scroll&&t.params.scrollParent,this.scrollSpeed=e.scrollSpeed||1,this.scrollThreshold=e.scrollThreshold||10;let r=null==e.channelIdx?-1:parseInt(e.channelIdx);this.regionHeight="100%",this.marginTop="0px";let n=this.wavesurfer.backend.ac.destination.channelCount;r>=0&&r<n&&(this.regionHeight=Math.floor(1/n*100)+"%",this.marginTop=this.wavesurfer.getHeight()*r+"px"),this.bindInOut(),this.render(),this.wavesurfer.on("zoom",this._onRedraw),this.wavesurfer.on("redraw",this._onRedraw),this.wavesurfer.fireEvent("region-created",this)}update(e){null!=e.start&&(this.start=Number(e.start)),null!=e.end&&(this.end=Number(e.end)),null!=e.loop&&(this.loop=Boolean(e.loop)),null!=e.color&&(this.color=e.color),null!=e.handleStyle&&(this.handleStyle=e.handleStyle),null!=e.data&&(this.data=e.data),null!=e.resize&&(this.resize=Boolean(e.resize)),null!=e.drag&&(this.drag=Boolean(e.drag)),null!=e.maxLength&&(this.maxLength=Number(e.maxLength)),null!=e.minLength&&(this.minLength=Number(e.minLength)),null!=e.attributes&&(this.attributes=e.attributes),this.updateRender(),this.fireEvent("update"),this.wavesurfer.fireEvent("region-updated",this)}remove(){this.element&&(this.wrapper.removeChild(this.element),this.element=null,this.fireEvent("remove"),this.wavesurfer.un("zoom",this._onRedraw),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.fireEvent("region-removed",this))}play(e){const t=e||this.start;this.wavesurfer.play(t,this.end),this.fireEvent("play"),this.wavesurfer.fireEvent("region-play",this)}playLoop(e){this.play(e),this.once("out",()=>this.playLoop())}render(){const e=document.createElement("region"),t=e.appendChild(document.createElement("handle")),r=e.appendChild(document.createElement("handle"));e.className="wavesurfer-region",e.title=this.formatTime(this.start,this.end),e.setAttribute("data-id",this.id);for(const t in this.attributes)e.setAttribute("data-region-"+t,this.attributes[t]);if(this.style(e,{position:"absolute",zIndex:2,height:this.regionHeight,top:this.marginTop}),this.handleStyle.left?t.style.backgroundColor=this.handleStyle.left.backgroundColor:t.style.backgroundColor="rgba(0, 0, 0, 1)",this.handleStyle.right?r.style.backgroundColor=this.handleStyle.right.backgroundColor:r.style.backgroundColor="rgba(0, 0, 0, 1)",this.resize){t.className="wavesurfer-handle wavesurfer-handle-start",r.className="wavesurfer-handle wavesurfer-handle-end";const e={cursor:"col-resize",position:"absolute",top:this.marginTop,width:"1%",maxWidth:"4px",height:this.regionHeight};this.style(t,e),this.style(t,{left:"0px"}),this.style(r,e),this.style(r,{right:"0px"})}this.element=this.wrapper.appendChild(e),this.updateRender(),this.bindEvents(e)}formatTime(e,t){return(e==t?[e]:[e,t]).map(e=>[Math.floor(e%3600/60),("00"+Math.floor(e%60)).slice(-2)].join(":")).join("-")}getWidth(){return this.wavesurfer.drawer.width/this.wavesurfer.params.pixelRatio}updateRender(){const e=this.wavesurfer.getDuration(),t=this.getWidth();var r=this.start,n=this.end;if(r<0&&(n-=r=0),n>e&&(r=e-((n=e)-r)),null!=this.minLength&&(n=Math.max(r+this.minLength,n)),null!=this.maxLength&&(n=Math.min(r+this.maxLength,n)),null!=this.element){const i=Math.round(r/e*t),s=Math.round(n/e*t)-i;this.style(this.element,{left:i+"px",width:s+"px",backgroundColor:this.color,cursor:this.drag?"move":"default"});for(const e in this.attributes)this.element.setAttribute("data-region-"+e,this.attributes[e]);this.element.title=this.formatTime(this.start,this.end)}}bindInOut(){this.firedIn=!1,this.firedOut=!1;const e=e=>{let t=Math.round(10*this.start)/10,r=Math.round(10*this.end)/10;e=Math.round(10*e)/10,!this.firedOut&&this.firedIn&&(t>e||r<=e)&&(this.firedOut=!0,this.firedIn=!1,this.fireEvent("out"),this.wavesurfer.fireEvent("region-out",this)),!this.firedIn&&t<=e&&r>e&&(this.firedIn=!0,this.firedOut=!1,this.fireEvent("in"),this.wavesurfer.fireEvent("region-in",this))};this.wavesurfer.backend.on("audioprocess",e),this.on("remove",()=>{this.wavesurfer.backend.un("audioprocess",e)}),this.on("out",()=>{this.loop&&this.wavesurfer.play(this.start)})}bindEvents(){this.element.addEventListener("mouseenter",e=>{this.fireEvent("mouseenter",e),this.wavesurfer.fireEvent("region-mouseenter",this,e)}),this.element.addEventListener("mouseleave",e=>{this.fireEvent("mouseleave",e),this.wavesurfer.fireEvent("region-mouseleave",this,e)}),this.element.addEventListener("click",e=>{e.preventDefault(),this.fireEvent("click",e),this.wavesurfer.fireEvent("region-click",this,e)}),this.element.addEventListener("dblclick",e=>{e.stopPropagation(),e.preventDefault(),this.fireEvent("dblclick",e),this.wavesurfer.fireEvent("region-dblclick",this,e)}),(this.drag||this.resize)&&this.bindDragEvents()}bindDragEvents(){const e=this.wavesurfer.drawer.container,t=this.scrollSpeed,r=this.scrollThreshold;let n,i,s,a,o,c,u,l=!1;const d=e=>{const r=this.wavesurfer.getDuration();if(!c||!s&&!o)return;let i=this.wrapper.scrollLeft+t*c;this.wrapper.scrollLeft=i=Math.min(a,Math.max(0,i));const u=this.wavesurfer.regions.util.getRegionSnapToGridValue(this.wavesurfer.drawer.handleEvent(e)*r),l=u-n;n=u,s?this.onDrag(l):this.onResize(l,o),window.requestAnimationFrame(()=>{d(e)})},h=e=>{const t=this.wavesurfer.getDuration();e.touches&&e.touches.length>1||(i=e.targetTouches?e.targetTouches[0].identifier:null,(this.drag||this.resize)&&e.stopPropagation(),n=this.wavesurfer.regions.util.getRegionSnapToGridValue(this.wavesurfer.drawer.handleEvent(e,!0)*t),a=this.wrapper.scrollWidth-this.wrapper.clientWidth,u=this.wrapper.getBoundingClientRect(),this.isResizing=!1,this.isDragging=!1,"handle"===e.target.tagName.toLowerCase()?(this.isResizing=!0,o=e.target.classList.contains("wavesurfer-handle-start")?"start":"end"):(this.isDragging=!0,s=!0,o=!1))},f=e=>{e.touches&&e.touches.length>1||((s||o)&&(this.isDragging=!1,this.isResizing=!1,s=!1,c=null,o=!1),l&&(l=!1,this.util.preventClick(),this.fireEvent("update-end",e),this.wavesurfer.fireEvent("region-update-end",this,e)))},p=t=>{const a=this.wavesurfer.getDuration();if(t.touches&&t.touches.length>1)return;if(t.targetTouches&&t.targetTouches[0].identifier!=i)return;if(!s&&!o)return;const h=n,f=this.wavesurfer.regions.util.getRegionSnapToGridValue(this.wavesurfer.drawer.handleEvent(t)*a),p=f-n;if(n=f,this.drag&&s&&(l=l||!!p,this.onDrag(p)),this.resize&&o&&(l=l||!!p,this.onResize(p,o)),this.scroll&&e.clientWidth<this.wrapper.scrollWidth){if(s){const e=this.element.getBoundingClientRect();let t=e.left-u.left;f<h&&t>=0?c=-1:f>h&&t+e.width<=u.right&&(c=1),(-1===c&&t>r||1===c&&t+e.width<u.right-r)&&(c=null)}else{let e=t.clientX-u.left;c=e<=r?-1:e>=u.right-r?1:null}c&&d(t)}};this.element.addEventListener("mousedown",h),this.element.addEventListener("touchstart",h),this.wrapper.addEventListener("mousemove",p),this.wrapper.addEventListener("touchmove",p),document.body.addEventListener("mouseup",f),document.body.addEventListener("touchend",f),this.on("remove",()=>{document.body.removeEventListener("mouseup",f),document.body.removeEventListener("touchend",f),this.wrapper.removeEventListener("mousemove",p),this.wrapper.removeEventListener("touchmove",p)}),this.wavesurfer.on("destroy",()=>{document.body.removeEventListener("mouseup",f),document.body.removeEventListener("touchend",f)})}onDrag(e){const t=this.wavesurfer.getDuration();this.end+e>t||this.start+e<0||this.update({start:this.start+e,end:this.end+e})}onResize(e,t){"start"===t?this.update({start:Math.min(this.start+e,this.end),end:Math.max(this.start+e,this.end)}):this.update({start:Math.min(this.end+e,this.start),end:Math.max(this.end+e,this.start)})}}class g{static create(e){return{name:"regions",deferInit:!(!e||!e.deferInit)&&e.deferInit,params:e,staticProps:{addRegion(e){return this.initialisedPluginList.regions||this.initPlugin("regions"),this.regions.add(e)},clearRegions(){this.regions&&this.regions.clear()},enableDragSelection(e){this.initialisedPluginList.regions||this.initPlugin("regions"),this.regions.enableDragSelection(e)},disableDragSelection(){this.regions.disableDragSelection()}},instance:g}}constructor(e,t){this.params=e,this.wavesurfer=t,this.util={...t.util,getRegionSnapToGridValue:t=>this.getRegionSnapToGridValue(t,e)},this.maxRegions=e.maxRegions;Object.getOwnPropertyNames(this.util.Observer.prototype).forEach(e=>{v.prototype[e]=this.util.Observer.prototype[e]}),this.wavesurfer.Region=v,this._onBackendCreated=()=>{this.wrapper=this.wavesurfer.drawer.wrapper,this.params.regions&&this.params.regions.forEach(e=>{this.add(e)})},this.list={},this._onReady=()=>{this.wrapper=this.wavesurfer.drawer.wrapper,this.params.dragSelection&&this.enableDragSelection(this.params),Object.keys(this.list).forEach(e=>{this.list[e].updateRender()})}}init(){this.wavesurfer.isReady?(this._onBackendCreated(),this._onReady()):(this.wavesurfer.once("ready",this._onReady),this.wavesurfer.once("backend-created",this._onBackendCreated))}destroy(){this.wavesurfer.un("ready",this._onReady),this.wavesurfer.un("backend-created",this._onBackendCreated),this.disableDragSelection(),this.clear()}wouldExceedMaxRegions(){return this.maxRegions&&Object.keys(this.list).length>=this.maxRegions}add(e){if(this.wouldExceedMaxRegions())return null;const t=new this.wavesurfer.Region(e,this.wavesurfer);return this.list[t.id]=t,t.on("remove",()=>{delete this.list[t.id]}),t}clear(){Object.keys(this.list).forEach(e=>{this.list[e].remove()})}enableDragSelection(e){this.disableDragSelection();const t=e.slop||2,r=this.wavesurfer.drawer.container,n=!1!==e.scroll&&this.wavesurfer.params.scrollParent,i=e.scrollSpeed||1,s=e.scrollThreshold||10;let a,o,c,u,l,d,h,f=this.wavesurfer.getDuration(),p=0;const m=e=>{if(!u||!d)return;let t=this.wrapper.scrollLeft+i*d;this.wrapper.scrollLeft=t=Math.min(o,Math.max(0,t));const r=this.wavesurfer.drawer.handleEvent(e);u.update({start:Math.min(r*f,c*f),end:Math.max(r*f,c*f)}),t<o&&t>0&&window.requestAnimationFrame(()=>{m(e)})},v=e=>{e.touches&&e.touches.length>1||(f=this.wavesurfer.getDuration(),l=e.targetTouches?e.targetTouches[0].identifier:null,o=this.wrapper.scrollWidth-this.wrapper.clientWidth,h=this.wrapper.getBoundingClientRect(),a=!0,c=this.wavesurfer.drawer.handleEvent(e,!0),u=null,d=null)};this.wrapper.addEventListener("mousedown",v),this.wrapper.addEventListener("touchstart",v),this.on("disable-drag-selection",()=>{this.wrapper.removeEventListener("touchstart",v),this.wrapper.removeEventListener("mousedown",v)});const g=e=>{e.touches&&e.touches.length>1||(a=!1,p=0,d=null,u&&(this.util.preventClick(),u.fireEvent("update-end",e),this.wavesurfer.fireEvent("region-update-end",u,e)),u=null)};this.wrapper.addEventListener("mouseup",g),this.wrapper.addEventListener("touchend",g),document.body.addEventListener("mouseup",g),document.body.addEventListener("touchend",g),this.on("disable-drag-selection",()=>{document.body.removeEventListener("mouseup",g),document.body.removeEventListener("touchend",g),this.wrapper.removeEventListener("touchend",g),this.wrapper.removeEventListener("mouseup",g)});const y=i=>{if(!a)return;if(++p<=t)return;if(i.touches&&i.touches.length>1)return;if(i.targetTouches&&i.targetTouches[0].identifier!=l)return;if(!u&&(u=this.add(e||{}),!u))return;const o=this.wavesurfer.drawer.handleEvent(i),v=this.wavesurfer.regions.util.getRegionSnapToGridValue(c*f),g=this.wavesurfer.regions.util.getRegionSnapToGridValue(o*f);if(u.update({start:Math.min(g,v),end:Math.max(g,v)}),n&&r.clientWidth<this.wrapper.scrollWidth){const e=i.clientX-h.left;d=e<=s?-1:e>=h.right-s?1:null,d&&m(i)}};this.wrapper.addEventListener("mousemove",y),this.wrapper.addEventListener("touchmove",y),this.on("disable-drag-selection",()=>{this.wrapper.removeEventListener("touchmove",y),this.wrapper.removeEventListener("mousemove",y)})}disableDragSelection(){this.fireEvent("disable-drag-selection")}getCurrentRegion(){const e=this.wavesurfer.getCurrentTime();let t=null;return Object.keys(this.list).forEach(r=>{const n=this.list[r];n.start<=e&&n.end>=e&&(!t||n.end-n.start<t.end-t.start)&&(t=n)}),t}getRegionSnapToGridValue(e,t){if(t.snapToGridInterval){const r=t.snapToGridOffset||0;return Math.round((e-r)/t.snapToGridInterval)*t.snapToGridInterval+r}return e}}class y{static create(e){return{name:"minimap",deferInit:!(!e||!e.deferInit)&&e.deferInit,params:e,staticProps:{},instance:y}}constructor(e,t){if(this.params=Object.assign({},t.params,{showRegions:!1,showOverview:!1,overviewBorderColor:"green",overviewBorderSize:2,container:!1,height:Math.max(Math.round(t.params.height/4),20)},e,{scrollParent:!1,fillParent:!0}),"string"==typeof e.container){const t=document.querySelector(e.container);t||console.warn(`Wavesurfer minimap container ${e.container} was not found! The minimap will be automatically appended below the waveform.`),this.params.container=t}e.container||(this.params.container=t.util.style(document.createElement("minimap"),{display:"block"})),this.drawer=new t.Drawer(this.params.container,this.params),this.wavesurfer=t,this.util=t.util,this.renderEvent="MediaElement"===t.params.backend?"waveform-ready":"ready",this.overviewRegion=null,this.drawer.createWrapper(),this.createElements();let r=!1;this._onShouldRender=()=>{r||(this.bindWavesurferEvents(),this.bindMinimapEvents(),r=!0),document.body.contains(this.params.container)||t.container.insertBefore(this.params.container,null),this.wavesurfer.regions&&this.params.showRegions&&this.regions(),this.render()},this._onAudioprocess=e=>{this.drawer.progress(this.wavesurfer.backend.getPlayedPercents())},this._onSeek=()=>this.drawer.progress(t.backend.getPlayedPercents()),this._onScroll=e=>{this.draggingOverview||this.moveOverviewRegion(e.target.scrollLeft/this.ratio)},this._onMouseover=e=>{this.draggingOverview&&(this.draggingOverview=!1)};let n=0;this._onResize=t.util.debounce(()=>{n!=this.drawer.wrapper.clientWidth&&(n=this.drawer.wrapper.clientWidth,this.render(),this.drawer.progress(this.wavesurfer.backend.getPlayedPercents()))}),this._onZoom=e=>{this.render()},this.wavesurfer.on("zoom",this._onZoom)}init(){this.wavesurfer.isReady&&this._onShouldRender(),this.wavesurfer.on(this.renderEvent,this._onShouldRender)}destroy(){window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0),this.wavesurfer.drawer.wrapper.removeEventListener("mouseover",this._onMouseover),this.wavesurfer.un(this.renderEvent,this._onShouldRender),this.wavesurfer.un("seek",this._onSeek),this.wavesurfer.un("scroll",this._onScroll),this.wavesurfer.un("audioprocess",this._onAudioprocess),this.wavesurfer.un("zoom",this._onZoom),this.drawer.destroy(),this.overviewRegion=null,this.unAll()}regions(){this.regions={},this.wavesurfer.on("region-created",e=>{this.regions[e.id]=e,this.renderRegions()}),this.wavesurfer.on("region-updated",e=>{this.regions[e.id]=e,this.renderRegions()}),this.wavesurfer.on("region-removed",e=>{delete this.regions[e.id],this.renderRegions()})}renderRegions(){const e=this.drawer.wrapper.querySelectorAll("region");let t;for(t=0;t<e.length;++t)this.drawer.wrapper.removeChild(e[t]);Object.keys(this.regions).forEach(e=>{const t=this.regions[e],r=this.getWidth()*((t.end-t.start)/this.wavesurfer.getDuration()),n=this.getWidth()*(t.start/this.wavesurfer.getDuration()),i=this.util.style(document.createElement("region"),{height:"inherit",backgroundColor:t.color,width:r+"px",left:n+"px",display:"block",position:"absolute"});i.classList.add(e),this.drawer.wrapper.appendChild(i)})}createElements(){this.drawer.createElements(),this.params.showOverview&&(this.overviewRegion=this.util.style(document.createElement("overview"),{top:0,bottom:0,width:"0px",display:"block",position:"absolute",cursor:"move",border:this.params.overviewBorderSize+"px solid "+this.params.overviewBorderColor,zIndex:2,opacity:this.params.overviewOpacity}),this.drawer.wrapper.appendChild(this.overviewRegion))}bindWavesurferEvents(){window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0),this.wavesurfer.on("audioprocess",this._onAudioprocess),this.wavesurfer.on("seek",this._onSeek),this.params.showOverview&&(this.wavesurfer.on("scroll",this._onScroll),this.wavesurfer.drawer.wrapper.addEventListener("mouseover",this._onMouseover))}bindMinimapEvents(){const e={clientX:0,clientY:0};let t=0,r=!0;this.params.interact&&(this.drawer.wrapper.addEventListener("click",e=>{this.fireEvent("click",e,this.drawer.handleEvent(e))}),this.on("click",(e,t)=>{r?(this.drawer.progress(t),this.wavesurfer.seekAndCenter(t)):r=!0})),this.params.showOverview&&(this.overviewRegion.addEventListener("mousedown",r=>{this.draggingOverview=!0,t=r.layerX,e.clientX=r.clientX,e.clientY=r.clientY}),this.drawer.wrapper.addEventListener("mousemove",e=>{this.draggingOverview&&this.moveOverviewRegion(e.clientX-this.drawer.container.getBoundingClientRect().left-t)}),this.drawer.wrapper.addEventListener("mouseup",t=>{e.clientX-t.clientX==0&&e.clientX-t.clientX==0?(r=!0,this.draggingOverview=!1):this.draggingOverview&&(r=!1,this.draggingOverview=!1)}))}render(){const e=this.drawer.getWidth(),t=this.wavesurfer.backend.getPeaks(e,0,e);this.drawer.drawPeaks(t,e,0,e),this.drawer.progress(this.wavesurfer.backend.getPlayedPercents()),this.params.showOverview&&(this.ratio=this.wavesurfer.drawer.width/this.drawer.width,this.waveShowedWidth=this.wavesurfer.drawer.width/this.ratio,this.waveWidth=this.wavesurfer.drawer.width,this.overviewWidth=this.drawer.container.offsetWidth/this.ratio,this.overviewPosition=0,this.moveOverviewRegion(this.wavesurfer.drawer.wrapper.scrollLeft/this.ratio),this.overviewRegion.style.width=this.overviewWidth+"px")}moveOverviewRegion(e){e<0?this.overviewPosition=0:e+this.overviewWidth<this.drawer.container.offsetWidth?this.overviewPosition=e:this.overviewPosition=this.drawer.container.offsetWidth-this.overviewWidth,this.overviewRegion.style.left=this.overviewPosition+"px",this.draggingOverview&&(this.wavesurfer.drawer.wrapper.scrollLeft=this.overviewPosition*this.ratio)}getWidth(){return this.drawer.width/this.params.pixelRatio}}var w=r(34),b=r.n(w);class _{constructor(e,t,r,n){this.sortedRegions=[],this.currentActions=[],this.updateBeginAndEnd=e=>{e.start<0&&(e.start=0),this.editFormHandler.getRegionStartInput().value=""+Math.round(100*(e.start+Number.EPSILON))/100,this.editFormHandler.getRegionEndInput().value=""+Math.round(100*(e.end+Number.EPSILON))/100},this.redrawAllRegionsSuperposed=()=>{const e=this.getRegionsIdSorted();for(const t of e){const r=this.wavesurfer.regions.list[t];this.drawRegionSuperposed(r,e)}},this.saveRegions=()=>{this.sortedRegions=this.getRegionsIdSorted().map(e=>{const t=this.wavesurfer.regions.list[e];return{start:Math.round(100*(t.start+Number.EPSILON))/100,end:Math.round(100*(t.end+Number.EPSILON))/100,data:t.data}}),this.redrawAllRegionsSuperposed(),localStorage.regions=JSON.stringify(this.sortedRegions,(e,t)=>{switch(e){case"canvas":return;default:return t}},2)},this.canvas=r,this.editFormHandler=n,this.wavesurfer=m.a.create({container:d.a.getWaveformDiv(),height:200,pixelRatio:1,minPxPerSec:100,scrollParent:!0,normalize:!0,splitChannels:!1,backend:"MediaElement",plugins:[g.create(),y.create({height:30,waveColor:"#ddd",progressColor:"#999"})]}),this.wavesurfer.on("error",(function(e){console.warn(e)}));const i=new Audio;i.src=URL.createObjectURL(e),this.wavesurfer.load(i),this.wavesurfer.on("ready",()=>{this.wavesurfer.enableDragSelection({color:"rgba(128, 204, 0, 0.5)"}),this.loadRegions(t),this.saveRegions(),this.wavesurfer.seekAndCenter(0),this.initZoomSlider()}),this.initPlayButton(),this.initExportButton(),this.editFormHandler.editForm.getRegionStartInput().addEventListener("input",()=>{this.selectedRegion.update({start:this.editFormHandler.editForm.getRegionStartInput().value})}),this.editFormHandler.editForm.getRegionEndInput().addEventListener("input",()=>{this.selectedRegion.update({end:this.editFormHandler.editForm.getRegionEndInput().value})}),this.editFormHandler.editForm.getDeleteRegionButton().addEventListener("click",()=>{this.deleteRegion(this.selectedRegion),this.redrawAllRegionsSuperposed()}),this.wavesurfer.on("region-click",this.editFormHandler.editAction),this.wavesurfer.on("region-click",e=>{this.selectedRegion=e}),this.wavesurfer.on("region-updated",this.saveRegions),this.wavesurfer.on("region-updated",this.updateBeginAndEnd),this.wavesurfer.on("region-update-end",this.saveRegions),this.wavesurfer.on("region-update-end",this.redrawAllRegionsSuperposed),this.wavesurfer.on("region-removed",this.saveRegions),this.wavesurfer.on("region-play",(function(e){e.once("out",(function(){this.wavesurfer.play(e.start),this.wavesurfer.pause()}))})),this.wavesurfer.on("region-mouseenter",e=>{this.regionChangeHandles(e,"10%","10px")}),this.wavesurfer.on("region-mouseleave",e=>{this.regionChangeHandles(e,"1%","3px")}),this.wavesurfer.on("play",()=>{d.a.getPlayPauseButton().textContent="⏸️  PAUSE",d.a.getPlayPauseButton().style.backgroundColor="#ff751f"}),this.wavesurfer.on("pause",()=>{d.a.getPlayPauseButton().textContent="▶️  PLAY",d.a.getPlayPauseButton().style.backgroundColor="#009e47"}),this.wavesurfer.on("audioprocess",()=>{const e=this.wavesurfer.getCurrentTime();for(const t of this.sortedRegions)if(null!=t.data.action){const r=t.data.action,n=e>=t.start&&e<=t.end,i=null!=this.currentActions.find(e=>l.isEquivalent(e,r));if(n)i||this.currentActions.push(r);else{e>=t.end&&i&&(this.currentActions=this.currentActions.filter(e=>!l.isEquivalent(e,r)))}}this.canvas.executeActions(this.currentActions)}),this.wavesurfer.on("seek",()=>{if(null!=this.selectedRegion){const e=this.wavesurfer.getCurrentTime();(e<=this.selectedRegion.start||e>=this.selectedRegion.end)&&(this.selectedRegion=void 0,this.editFormHandler.resetActionDiv(),this.editFormHandler.editForm.reset())}}),this.wavesurfer.on("seek",()=>{const e=this.wavesurfer.getCurrentTime();this.currentActions=[];for(const t of this.sortedRegions)if(null!=t.data.action){const r=t.data.action,n=e>=t.start&&e<=t.end,i=null!=this.currentActions.find(e=>l.isEquivalent(e,r));if(n)i||this.currentActions.push(r);else{const n=e>=t.end,s=e<t.start,a=e>t.end;(n&&i||s||a)&&(this.currentActions=this.currentActions.filter(e=>!l.isEquivalent(e,r)))}}this.canvas.executeActions(this.currentActions)}),this.wavesurfer.on("finish",()=>{this.currentActions=[],this.selectedRegion=void 0,this.canvas.renderFullImage()})}regionChangeHandles(e,t,r){e.element.childNodes.forEach((function(e){"HANDLE"==e.nodeName&&(e.style.width=t,e.style["max-width"]=r)}))}drawRegionSuperposed(e,t){const r=e.element;r.title=Math.round(100*(e.start+Number.EPSILON))/100+" -> "+Math.round(100*(e.end+Number.EPSILON))/100,r.style.height="10%";let n=0;for(const r of t){if(e.id==r)break;const t=e.start,i=e.end,s=this.wavesurfer.regions.list[r],a=s.start,o=s.end,c=t<=a&&i>=o,u=t>=a&&t<o,l=i>a&&i<=o;if(t>=a&&i<=o||u||l||c){Number(s.element.style.top.replace("px",""))<=n&&(n+=this.wavesurfer.params.height/10)}}r.style.top=n+"px"}initZoomSlider(){const e=d.a.getWaveformZoomSlider();e.value=this.wavesurfer.params.minPxPerSec,e.min=""+this.wavesurfer.params.minPxPerSec/5,e.max=""+10*this.wavesurfer.params.minPxPerSec,e.step=""+.1*this.wavesurfer.params.minPxPerSec,e.addEventListener("input",()=>{this.wavesurfer.zoom(Number(e.value))}),this.wavesurfer.zoom(Number(e.value))}initPlayButton(){d.a.getPlayPauseButton().addEventListener("click",()=>this.wavesurfer.playPause())}initExportButton(){d.a.getExportButton().addEventListener("click",()=>{u.a.localFileContentsToString("./assets/actions_json_schema.json").then(e=>{const t=JSON.parse(localStorage.regions),r=new b.a,n=JSON.parse(e);r.addSchema(n,"schema").validate("schema",t)?u.a.saveBlobToFile(new Blob([localStorage.regions],{type:"application/json"}),"actions.json"):alert("Cannot export : \n"+this.ajvErrorsToErrorMessage(JSON.stringify(r.errors)))})})}ajvErrorsToErrorMessage(e){const t=JSON.parse(e),r=/\[([0-9]+)].*/,n=[];return t.forEach(e=>{const t=parseInt(r.exec(e.dataPath)[1]),i=JSON.parse(localStorage.regions)[t],s="- region "+(t+1)+" ("+i.data.action.type+", "+i.start+" -> "+i.end+") "+e.message;n.push(s)}),n.join("\n")}getRegionsIdSorted(){return Object.keys(this.wavesurfer.regions.list).sort((e,t)=>{const r=this.wavesurfer.regions.list[e],n=this.wavesurfer.regions.list[t],i=r.start,s=r.end,a=n.start,o=n.end;return i-a==0?s-i-(o-a):i-a})}loadRegions(e){e.forEach(e=>{e.color=this.randomColor(.5);const t=e.data.action.options,r=e.data.action.type;let u,l;switch(r){case"draw_arrow":u=new f.b(t.originX,t.originY,t.destinationX,t.destinationY,t.lineWidth,t.color),l=new f.a(this.canvas,u);break;case"draw_circle":u=new i.b(t.centerX,t.centerY,t.radius,t.borderSize,t.color),l=new i.a(this.canvas,u);break;case"draw_point":u=new h.b(t.centerX,t.centerY,t.radius,t.color),l=new h.a(this.canvas,u);break;case"draw_rectangle":u=new n.b(t.topLeftX,t.topLeftY,t.bottomRightX,t.bottomRightY,t.borderSize,t.color),l=new n.a(this.canvas,u);break;case"draw_xcross":u=new s.b(t.centerX,t.centerY,t.radius,t.lineWidth,t.color),l=new s.a(this.canvas,t);break;case"zoom":u=new a.b(t.topLeftX,t.topLeftY,t.bottomRightX,t.bottomRightY),l=new a.a(this.canvas,u);break;case"subtitle":u=new o.b(t.text,t.position,t.backgroundColor,t.backgroundColorOpacity,t.textColor,t.fontSize,"Roboto Medium"),l=new o.a(this.canvas,u);break;case"focus_rectangle":u=new c.b(t.topLeftX,t.topLeftY,t.bottomRightX,t.bottomRightY),l=new c.a(this.canvas,u);break;default:throw new Error("Unsupported action : "+r)}e.data.action=l,e.data.action.type=r,e.data.action.options=u,this.wavesurfer.addRegion(e)})}deleteRegion(e){if(null!=e){const t=e.id;null!=this.wavesurfer.regions.list[t]&&(this.wavesurfer.regions.list[t].remove(),this.selectedRegion=void 0,this.editFormHandler.editForm.reset(),this.saveRegions())}}randomColor(e){return"rgba("+[~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random()),e||1]+")"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;const n=new Set(["string","number","integer","boolean","null","object","array"]);t.isJSONType=function(e){return"string"==typeof e&&n.has(e)},t.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{type:!0,$comment:!0},keywords:{type:!0,$comment:!0}}}},function(e,t,r){"use strict";function n(e,t){return t.rules.some(t=>i(e,t))}function i(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=function({schema:e,self:t},r){const i=t.RULES.types[r];return i&&!0!==i&&n(e,i)},t.shouldUseGroup=n,t.shouldUseRule=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=void 0;const n=r(22);class i extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}t.varKinds={const:new n.Name("const"),let:new n.Name("let"),var:new n.Name("var")};class s{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof n.Name?e:this.name(e)}name(e){return new n.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}t.Scope=s;class a extends n.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:r}){this.value=e,this.scopePath=n._`.${new n.Name(t)}[${r}]`}}t.ValueScopeName=a;const o=n._`\n`;t.ValueScope=class extends s{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?o:n.nil}}get(){return this._scope}name(e){return new a(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:i}=n,s=null!==(r=t.key)&&void 0!==r?r:t.ref;let a=this._values[i];if(a){const e=a.get(s);if(e)return e}else a=this._values[i]=new Map;a.set(s,n);const o=this._scope[i]||(this._scope[i]=[]),c=o.length;return o[c]=t.ref,n.setValue(t,{property:i,itemIndex:c}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error(`CodeGen: name "${t}" has no value`);return n._`${e}${t.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(e,r,s={},a){let o=n.nil;for(const c in e){const u=e[c];if(!u)continue;const l=s[c]=s[c]||new Set;u.forEach(e=>{if(l.has(e))return;l.add(e);let s=r(e);if(s){const r=this.opts.es5?t.varKinds.var:t.varKinds.const;o=n._`${o}${r} ${e} = ${s};${this.opts._n}`}else{if(!(s=null==a?void 0:a(e)))throw new i(e);o=n._`${o}${s}${this.opts._n}`}})}return o}}},function(e,t,r){
/** @license URI.js v4.4.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function s(e){var n=t("[0-9]","[A-Fa-f]"),i=r(r("%[EFef]"+n+"%"+n+n+"%"+n+n)+"|"+r("%[89A-Fa-f]"+n+"%"+n+n)+"|"+r("%"+n+n)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",a=t("[\\:\\/\\?\\#\\[\\]\\@]",s),o=e?"[\\uE000-\\uF8FF]":"[]",c=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),u=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),l=r(r(i+"|"+t(c,s,"[\\:]"))+"*"),d=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),h=r(d+"\\."+d+"\\."+d+"\\."+d),f=r(n+"{1,4}"),p=r(r(f+"\\:"+f)+"|"+h),m=r(r(f+"\\:")+"{6}"+p),v=r("\\:\\:"+r(f+"\\:")+"{5}"+p),g=r(r(f)+"?\\:\\:"+r(f+"\\:")+"{4}"+p),y=r(r(r(f+"\\:")+"{0,1}"+f)+"?\\:\\:"+r(f+"\\:")+"{3}"+p),w=r(r(r(f+"\\:")+"{0,2}"+f)+"?\\:\\:"+r(f+"\\:")+"{2}"+p),b=r(r(r(f+"\\:")+"{0,3}"+f)+"?\\:\\:"+f+"\\:"+p),_=r(r(r(f+"\\:")+"{0,4}"+f)+"?\\:\\:"+p),E=r(r(r(f+"\\:")+"{0,5}"+f)+"?\\:\\:"+f),k=r(r(r(f+"\\:")+"{0,6}"+f)+"?\\:\\:"),P=r([m,v,g,y,w,b,_,E,k].join("|")),$=r(r(c+"|"+i)+"+"),C=(r(P+"\\%25"+$),r(P+r("\\%25|\\%(?!"+n+"{2})")+$)),S=r("[vV]"+n+"+\\."+t(c,s,"[\\:]")+"+"),x=r("\\["+r(C+"|"+P+"|"+S)+"\\]"),R=r(r(i+"|"+t(c,s))+"*"),O=r(x+"|"+h+"(?!"+R+")|"+R),j=r("[0-9]*"),T=r(r(l+"@")+"?"+O+r("\\:"+j)+"?"),I=r(i+"|"+t(c,s,"[\\:\\@]")),N=r(I+"*"),M=r(I+"+"),A=r(r(i+"|"+t(c,s,"[\\@]"))+"+"),L=r(r("\\/"+N)+"*"),D=r("\\/"+r(M+L)+"?"),F=r(A+L),W=r(M+L),V="(?!"+I+")",z=(r(L+"|"+D+"|"+F+"|"+W+"|"+V),r(r(I+"|"+t("[\\/\\?]",o))+"*")),B=r(r(I+"|[\\/\\?]")+"*"),H=r(r("\\/\\/"+T+L)+"|"+D+"|"+W+"|"+V),q=r(u+"\\:"+H+r("\\?"+z)+"?"+r("\\#"+B)+"?"),X=r(r("\\/\\/"+T+L)+"|"+D+"|"+F+"|"+V),Y=r(X+r("\\?"+z)+"?"+r("\\#"+B)+"?");return r(q+"|"+Y),r(u+"\\:"+H+r("\\?"+z)+"?"),r(r("\\/\\/("+r("("+l+")@")+"?("+O+")"+r("\\:("+j+")")+"?)")+"?("+L+"|"+D+"|"+W+"|"+V+")"),r("\\?("+z+")"),r("\\#("+B+")"),r(r("\\/\\/("+r("("+l+")@")+"?("+O+")"+r("\\:("+j+")")+"?)")+"?("+L+"|"+D+"|"+F+"|"+V+")"),r("\\?("+z+")"),r("\\#("+B+")"),r(r("\\/\\/("+r("("+l+")@")+"?("+O+")"+r("\\:("+j+")")+"?)")+"?("+L+"|"+D+"|"+W+"|"+V+")"),r("\\?("+z+")"),r("\\#("+B+")"),r("("+l+")@"),r("\\:("+j+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",c,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",c,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",c,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",c,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",c,s,"[\\:\\@\\/\\?]",o),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",c,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",c,s),"g"),UNRESERVED:new RegExp(c,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",c,a),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+h+")$"),IPV6ADDRESS:new RegExp("^\\[?("+P+")"+r(r("\\%25|\\%(?!"+n+"{2})")+"("+$+")")+"?\\]?$")}}var a=s(!1),o=s(!0),c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=2147483647,l=/^xn--/,d=/[^\0-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function v(e){throw new RangeError(f[e])}function g(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}((e=e.replace(h,".")).split("."),t).join(".");return n+i}function y(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var s=e.charCodeAt(r++);56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),r--)}else t.push(i)}return t}var w=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},b=function(e,t,r){var n=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;n+=36)e=p(e/35);return p(n+36*e/(e+38))},_=function(e){var t,r=[],n=e.length,i=0,s=128,a=72,o=e.lastIndexOf("-");o<0&&(o=0);for(var c=0;c<o;++c)e.charCodeAt(c)>=128&&v("not-basic"),r.push(e.charCodeAt(c));for(var l=o>0?o+1:0;l<n;){for(var d=i,h=1,f=36;;f+=36){l>=n&&v("invalid-input");var m=(t=e.charCodeAt(l++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>p((u-i)/h))&&v("overflow"),i+=m*h;var g=f<=a?1:f>=a+26?26:f-a;if(m<g)break;var y=36-g;h>p(u/y)&&v("overflow"),h*=y}var w=r.length+1;a=b(i-d,w,0==d),p(i/w)>u-s&&v("overflow"),s+=p(i/w),i%=w,r.splice(i++,0,s)}return String.fromCodePoint.apply(String,r)},E=function(e){var t=[],r=(e=y(e)).length,n=128,i=0,s=72,a=!0,o=!1,c=void 0;try{for(var l,d=e[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var h=l.value;h<128&&t.push(m(h))}}catch(e){o=!0,c=e}finally{try{!a&&d.return&&d.return()}finally{if(o)throw c}}var f=t.length,g=f;for(f&&t.push("-");g<r;){var _=u,E=!0,k=!1,P=void 0;try{for(var $,C=e[Symbol.iterator]();!(E=($=C.next()).done);E=!0){var S=$.value;S>=n&&S<_&&(_=S)}}catch(e){k=!0,P=e}finally{try{!E&&C.return&&C.return()}finally{if(k)throw P}}var x=g+1;_-n>p((u-i)/x)&&v("overflow"),i+=(_-n)*x,n=_;var R=!0,O=!1,j=void 0;try{for(var T,I=e[Symbol.iterator]();!(R=(T=I.next()).done);R=!0){var N=T.value;if(N<n&&++i>u&&v("overflow"),N==n){for(var M=i,A=36;;A+=36){var L=A<=s?1:A>=s+26?26:A-s;if(M<L)break;var D=M-L,F=36-L;t.push(m(w(L+D%F,0))),M=p(D/F)}t.push(m(w(M,0))),s=b(i,x,g==f),i=0,++g}}}catch(e){O=!0,j=e}finally{try{!R&&I.return&&I.return()}finally{if(O)throw j}}++i,++n}return t.join("")},k=function(e){return g(e,(function(e){return d.test(e)?"xn--"+E(e):e}))},P=function(e){return g(e,(function(e){return l.test(e)?_(e.slice(4).toLowerCase()):e}))},$={};function C(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function S(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var s=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&s)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var a=parseInt(e.substr(r+4,2),16),o=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&o)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function x(e,t){function r(e){var r=S(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,C).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,C).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,C).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,C).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,C).replace(t.PCT_ENCODED,i)),e}function R(e){return e.replace(/^0*(.*)/,"$1")||"0"}function O(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=c(r,2)[1];return n?n.split(".").map(R).join("."):e}function j(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=c(r,3),i=n[1],s=n[2];if(i){for(var a=i.toLowerCase().split("::").reverse(),o=c(a,2),u=o[0],l=o[1],d=l?l.split(":").map(R):[],h=u.split(":").map(R),f=t.IPV4ADDRESS.test(h[h.length-1]),p=f?7:8,m=h.length-p,v=Array(p),g=0;g<p;++g)v[g]=d[g]||h[m+g]||"";f&&(v[p-1]=O(v[p-1],t));var y=v.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],w=void 0;if(y&&y.length>1){var b=v.slice(0,y.index),_=v.slice(y.index+y.length);w=b.join(":")+"::"+_.join(":")}else w=v.join(":");return s&&(w+="%"+s),w}return e}var T=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,I=void 0==="".match(/(){0}/)[1];function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?o:a;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(T);if(i){I?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=j(O(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var s=$[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||s&&s.unicodeSupport)x(r,n);else{if(r.host&&(t.domainHost||s&&s.domainHost))try{r.host=k(r.host.replace(n.PCT_ENCODED,S).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}x(r,a)}s&&s.parse&&s.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function M(e,t){var r=!1!==t.iri?o:a,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(j(O(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var A=/^\.\.?\//,L=/^\/\.(\/|$)/,D=/^\/\.\.(\/|$)/,F=/^\/?(?:.|\n)*?(?=\/|$)/;function W(e){for(var t=[];e.length;)if(e.match(A))e=e.replace(A,"");else if(e.match(L))e=e.replace(L,"/");else if(e.match(D))e=e.replace(D,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(F);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?o:a,n=[],i=$[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?P(e.host):k(e.host.replace(r.PCT_ENCODED,S).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}x(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var s=M(e,t);if(void 0!==s&&("suffix"!==t.reference&&n.push("//"),n.push(s),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var c=e.path;t.absolutePath||i&&i.absolutePath||(c=W(c)),void 0===s&&(c=c.replace(/^\/\//,"/%2F")),n.push(c)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function z(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],i={};return n||(e=N(V(e,r),r),t=N(V(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=W(t.path||""),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=W(t.path||""),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=W(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=W(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function B(e,t){return e&&e.toString().replace(t&&t.iri?o.PCT_ENCODED:a.PCT_ENCODED,S)}var H={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},q={scheme:"https",domainHost:H.domainHost,parse:H.parse,serialize:H.serialize};function X(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var Y={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=X(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(X(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=c(r,2),i=n[0],s=n[1];e.path=i&&"/"!==i?i:void 0,e.query=s,e.resourceName=void 0}return e.fragment=void 0,e}},U={scheme:"wss",domainHost:Y.domainHost,parse:Y.parse,serialize:Y.serialize},G={},K="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",J="[0-9A-Fa-f]",Z=r(r("%[EFef]"+J+"%"+J+J+"%"+J+J)+"|"+r("%[89A-Fa-f]"+J+"%"+J+J)+"|"+r("%"+J+J)),Q=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),ee=new RegExp(K,"g"),te=new RegExp(Z,"g"),re=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Q),"g"),ne=new RegExp(t("[^]",K,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),ie=ne;function se(e){var t=S(e);return t.match(ee)?t:e}var ae={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,s={},a=r.query.split("&"),o=0,c=a.length;o<c;++o){var u=a[o].split("=");switch(u[0]){case"to":for(var l=u[1].split(","),d=0,h=l.length;d<h;++d)n.push(l[d]);break;case"subject":r.subject=B(u[1],t);break;case"body":r.body=B(u[1],t);break;default:i=!0,s[B(u[0],t)]=B(u[1],t)}}i&&(r.headers=s)}r.query=void 0;for(var f=0,p=n.length;f<p;++f){var m=n[f].split("@");if(m[0]=B(m[0]),t.unicodeSupport)m[1]=B(m[1],t).toLowerCase();else try{m[1]=k(B(m[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}n[f]=m.join("@")}return r},serialize:function(e,t){var r,n=e,s=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(s){for(var a=0,o=s.length;a<o;++a){var c=String(s[a]),u=c.lastIndexOf("@"),l=c.slice(0,u).replace(te,se).replace(te,i).replace(re,C),d=c.slice(u+1);try{d=t.iri?P(d):k(B(d,t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}s[a]=l+"@"+d}n.path=s.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var f=[];for(var p in h)h[p]!==G[p]&&f.push(p.replace(te,se).replace(te,i).replace(ne,C)+"="+h[p].replace(te,se).replace(te,i).replace(ie,C));return f.length&&(n.query=f.join("&")),n}},oe=/^([^\:]+)\:(.*)/,ce={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(oe),n=e;if(r){var i=t.scheme||n.scheme||"urn",s=r[1].toLowerCase(),a=r[2],o=i+":"+(t.nid||s),c=$[o];n.nid=s,n.nss=a,n.path=void 0,c&&(n=c.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),s=$[i];s&&(e=s.serialize(e,t));var a=e,o=e.nss;return a.path=(n||t.nid)+":"+o,a}},ue=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,le={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ue)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};$[H.scheme]=H,$[q.scheme]=q,$[Y.scheme]=Y,$[U.scheme]=U,$[ae.scheme]=ae,$[ce.scheme]=ce,$[le.scheme]=le,e.SCHEMES=$,e.pctEncChar=C,e.pctDecChars=S,e.parse=N,e.removeDotSegments=W,e.serialize=V,e.resolveComponents=z,e.resolve=function(e,t,r){var n=function(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}({scheme:"null"},r);return V(z(N(e,n),N(t,n),n,!0),n)},e.normalize=function(e,t){return"string"==typeof e?e=V(N(e,t),t):"object"===n(e)&&(e=N(V(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=V(N(e,r),r):"object"===n(e)&&(e=V(e,r)),"string"==typeof t?t=V(N(t,r),r):"object"===n(t)&&(t=V(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?o.ESCAPE:a.ESCAPE,C)},e.unescapeComponent=B,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;const n=r(1),i=r(23),s=r(6),a=r(20),o=r(3),c=r(4),u=r(30);class l{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:a.normalizeId(null==r?void 0:r.$id),this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function d(e){const t=f.call(this,e);if(t)return t;const r=a.getFullPath(e.root.baseId),{es5:o,lines:u}=this.opts.code,{ownProperties:l}=this.opts,d=new n.CodeGen(this.scope,{es5:o,lines:u,ownProperties:l});let h;e.$async&&(h=d.scopeValue("Error",{ref:i.ValidationError,code:n._`require("ajv/dist/compile/error_classes").ValidationError`}));const p=d.scopeName("validate");e.validateName=p;const m={gen:d,allErrors:this.opts.allErrors,data:s.default.data,parentData:s.default.parentData,parentDataProperty:s.default.parentDataProperty,dataNames:[s.default.data],dataPathArr:[n.nil],dataLevel:0,dataTypes:[],topSchemaRef:d.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:n.stringify(e.schema)}:{ref:e.schema}),validateName:p,ValidationError:h,schema:e.schema,schemaEnv:e,strictSchema:!0,rootId:r,baseId:e.baseId||r,schemaPath:n.nil,errSchemaPath:"#",errorPath:n._`""`,opts:this.opts,self:this};let v;try{this._compilations.add(e),c.validateFunctionCode(m),d.optimize(this.opts.code.optimize);const t=d.toString();v=`${d.scopeRefs(s.default.scope)}return ${t}`,this.opts.code.process&&(v=this.opts.code.process(v,e));const r=new Function(""+s.default.self,""+s.default.scope,v)(this,this.scope.get());if(this.scope.value(p,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:p,validateCode:t,scopeValues:d._values}),this.opts.unevaluated){const{props:e,items:t}=m;r.evaluated={props:e instanceof n.Name?void 0:e,items:t instanceof n.Name?void 0:t,dynamicProps:e instanceof n.Name,dynamicItems:t instanceof n.Name},r.source&&(r.source.evaluated=n.stringify(r.evaluated))}return e.validate=r,e}catch(t){throw delete e.validate,delete e.validateName,v&&this.logger.error("Error compiling schema, function code:",v),t}finally{this._compilations.delete(e)}}function h(e){return a.inlineRef(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:d.call(this,e)}function f(e){for(const n of this._compilations)if(r=e,(t=n).schema===r.schema&&t.root===r.root&&t.baseId===r.baseId)return n;var t,r}function p(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||m.call(this,e,t)}function m(e,t){const r=u.parse(t),n=a._getFullPath(r),i=a.getFullPath(e.baseId);if(Object.keys(e.schema).length>0&&n===i)return g.call(this,r,e);const s=a.normalizeId(n),o=this.refs[s]||this.schemas[s];if("string"==typeof o){const t=m.call(this,e,o);if("object"!=typeof(null==t?void 0:t.schema))return;return g.call(this,r,t)}return"object"==typeof(null==o?void 0:o.schema)?(o.validate||d.call(this,o),s===a.normalizeId(t)?new l({schema:o.schema,root:e,baseId:i}):g.call(this,r,o)):void 0}t.SchemaEnv=l,t.compileSchema=d,t.resolveRef=function(e,t,r){var n;r=a.resolveUrl(t,r);const i=e.refs[r];if(i)return i;let s=p.call(this,e,r);if(void 0===s){const i=null===(n=e.localRefs)||void 0===n?void 0:n[r];i&&(s=new l({schema:i,root:e,baseId:t}))}return void 0!==s?e.refs[r]=h.call(this,s):void 0},t.resolveSchema=m;const v=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function g(e,{baseId:t,schema:r,root:n}){var i;if("/"!==(null===(i=e.fragment)||void 0===i?void 0:i[0]))return;for(const n of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;if(void 0===(r=r[o.unescapeFragment(n)]))return;!v.has(n)&&"object"==typeof r&&r.$id&&(t=a.resolveUrl(t,r.$id))}let s;if("boolean"!=typeof r&&r.$ref&&!o.schemaHasRulesButRef(r,this.RULES)){const e=a.resolveUrl(t,r.$ref);s=m.call(this,n,e)}return s=s||new l({schema:r,root:n,baseId:t}),s.schema!==s.root.schema?s:void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(1),s=r(6),a=r(10),o=r(3),c={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"should NOT have additional properties",params:({params:e})=>i._`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:c,data:u,errsCount:l,it:d}=e;if(!l)throw new Error("ajv implementation error");const{allErrors:h,opts:f}=d;if(d.props=!0,"all"!==f.removeAdditional&&o.alwaysValidSchema(d,r))return;const p=n.allSchemaProperties(c.properties),m=n.allSchemaProperties(c.patternProperties);function v(e){t.code(i._`delete ${u}[${e}]`)}function g(n){if("all"===f.removeAdditional||f.removeAdditional&&!1===r)v(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(h||t.break());if("object"==typeof r&&!o.alwaysValidSchema(d,r)){const r=t.name("valid");"failing"===f.removeAdditional?(y(n,r,!1),t.if(i.not(r),()=>{e.reset(),v(n)})):(y(n,r),h||t.if(i.not(r),()=>t.break()))}}}function y(t,r,n){const i={keyword:"additionalProperties",dataProp:t,dataPropType:a.Type.Str,strictSchema:d.strictSchema};!1===n&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,r)}t.forIn("key",u,e=>{p.length||m.length?t.if(function(e){let r;if(p.length>8){const t=o.schemaRefOrVal(d,c.properties,"properties");r=i._`${t}.hasOwnProperty(${e})`}else r=p.length?i.or(...p.map(t=>i._`${e} === ${t}`)):i.nil;return m.length&&(r=i.or(r,...m.map(r=>i._`${n.usePattern(t,r)}.test(${e})`))),i._`!(${r})`}(e),()=>g(e)):g(e)}),e.ok(i._`${l} === ${s.default.errors}`)}};t.default=c},function(e,t,r){
/*!
 * wavesurfer.js 3.3.0 (2019-12-30)
 * https://github.com/katspaugh/wavesurfer.js
 * @license BSD-3-Clause
 */
var n;window,n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/wavesurfer.js")}({"./node_modules/debounce/index.js":
/*!****************************************!*\
  !*** ./node_modules/debounce/index.js ***!
  \****************************************/
/*! no static exports found */function(e,t){function r(e,t,r){var n,i,s,a,o;function c(){var u=Date.now()-a;u<t&&u>=0?n=setTimeout(c,t-u):(n=null,r||(o=e.apply(s,i),s=i=null))}null==t&&(t=100);var u=function(){s=this,i=arguments,a=Date.now();var u=r&&!n;return n||(n=setTimeout(c,t)),u&&(o=e.apply(s,i),s=i=null),o};return u.clear=function(){n&&(clearTimeout(n),n=null)},u.flush=function(){n&&(o=e.apply(s,i),s=i=null,clearTimeout(n),n=null)},u}r.debounce=r,e.exports=r},"./src/drawer.canvasentry.js":
/*!***********************************!*\
  !*** ./src/drawer.canvasentry.js ***!
  \***********************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(/*! ./util/style */"./src/util/style.js")),i=s(r(/*! ./util/get-id */"./src/util/get-id.js"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,i.default)(this.constructor.name.toLowerCase()+"_"),this.canvasContextAttributes={}}var t,r,s;return t=e,(r=[{key:"initWave",value:function(e){this.wave=e,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(e){this.progress=e,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(e,t,r,i){this.start=this.wave.offsetLeft/t||0,this.end=this.start+e/t,this.wave.width=r,this.wave.height=i;var s={width:e+"px"};(0,n.default)(this.wave,s),this.hasProgressCanvas&&(this.progress.width=r,this.progress.height=i,(0,n.default)(this.progress,s))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(e,t){this.waveCtx.fillStyle=e,this.hasProgressCanvas&&(this.progressCtx.fillStyle=t)}},{key:"fillRects",value:function(e,t,r,n,i){this.fillRectToContext(this.waveCtx,e,t,r,n,i),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,e,t,r,n,i)}},{key:"fillRectToContext",value:function(e,t,r,n,i,s){e&&(s?this.drawRoundedRect(e,t,r,n,i,s):e.fillRect(t,r,n,i))}},{key:"drawRoundedRect",value:function(e,t,r,n,i,s){0!==i&&(i<0&&(r-=i*=-1),e.beginPath(),e.moveTo(t+s,r),e.lineTo(t+n-s,r),e.quadraticCurveTo(t+n,r,t+n,r+s),e.lineTo(t+n,r+i-s),e.quadraticCurveTo(t+n,r+i,t+n-s,r+i),e.lineTo(t+s,r+i),e.quadraticCurveTo(t,r+i,t,r+i-s),e.lineTo(t,r+s),e.quadraticCurveTo(t,r,t+s,r),e.closePath(),e.fill())}},{key:"drawLines",value:function(e,t,r,n,i,s){this.drawLineToContext(this.waveCtx,e,t,r,n,i,s),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,e,t,r,n,i,s)}},{key:"drawLineToContext",value:function(e,t,r,n,i,s,a){if(e){var o,c,u,l=t.length/2,d=Math.round(l*this.start),h=d,f=Math.round(l*this.end)+1,p=this.wave.width/(f-h-1),m=n+i,v=r/n;for(e.beginPath(),e.moveTo((h-d)*p,m),e.lineTo((h-d)*p,m-Math.round((t[2*h]||0)/v)),o=h;o<f;o++)c=t[2*o]||0,u=Math.round(c/v),e.lineTo((o-d)*p+this.halfPixel,m-u);for(var g=f-1;g>=h;g--)c=t[2*g+1]||0,u=Math.round(c/v),e.lineTo((g-d)*p+this.halfPixel,m-u);e.lineTo((h-d)*p,m-Math.round((t[2*h+1]||0)/v)),e.closePath(),e.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(e,t,r){var n=this;return"blob"===r?new Promise((function(r){n.wave.toBlob(r,e,t)})):"dataURL"===r?this.wave.toDataURL(e,t):void 0}}])&&a(t.prototype,r),s&&a(t,s),e}();t.default=o,e.exports=t.default},"./src/drawer.js":
/*!***********************!*\
  !*** ./src/drawer.js ***!
  \***********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}(r(/*! ./util */"./src/util/index.js"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=o(this,c(t).call(this))).container=e,n.params=r,n.width=0,n.height=r.height*n.params.pixelRatio,n.lastPos=0,n.wrapper=null,n}var r,i,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(i=[{key:"style",value:function(e,t){return n.style(e,t)}},{key:"createWrapper",value:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var r,n=e.targetTouches?e.targetTouches[0].clientX:e.clientX,i=this.wrapper.getBoundingClientRect(),s=this.width,a=this.getWidth();return!this.params.fillParent&&s<a?(r=(this.params.rtl?i.right-n:n-i.left)*(this.params.pixelRatio/s)||0)>1&&(r=1):r=((this.params.rtl?i.right-n:n-i.left)+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,r}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",(function(t){var r=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==r){var n=e.wrapper.getBoundingClientRect();if(t.clientY>=n.bottom-r)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))})),this.wrapper.addEventListener("dblclick",(function(t){e.params.interact&&e.fireEvent("dblclick",t,e.handleEvent(t))})),this.wrapper.addEventListener("scroll",(function(t){return e.fireEvent("scroll",t)}))}},{key:"drawPeaks",value:function(e,t,r,n){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,r,n):this.drawWave(e,0,r,n)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var r=this.wrapper.scrollLeft,n=~~(this.wrapper.clientWidth/2),i=this.wrapper.scrollWidth-this.wrapper.clientWidth,s=e-n,a=s-r;if(0!=i){if(!t&&-n<=a&&a<n){var o=this.params.autoCenterRate;o/=n,o*=i,s=r+(a=Math.max(-o,Math.min(o,a)))}(s=Math.max(0,Math.min(i,s)))!=r&&(this.wrapper.scrollLeft=s)}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var t=this.params.pixelRatio;if(e=Math.round(this.wrapper.scrollLeft*t),this.params.scrollParent){var r=~~(this.wrapper.scrollWidth*t-this.getWidth());e=Math.min(r,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){return this.width!=e&&(this.width=e,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"setHeight",value:function(e){return e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,r=Math.round(e*this.width)*t;if(r<this.lastPos||r-this.lastPos>=t){if(this.lastPos=r,this.params.scrollParent&&this.params.autoCenter){var n=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(n,this.params.autoCenterImmediately)}this.updateProgress(r)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,r,n){}},{key:"drawWave",value:function(e,t,r,n){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}])&&a(r.prototype,i),s&&a(r,s),t}(n.Observer);t.default=l,e.exports=t.default},"./src/drawer.multicanvas.js":
/*!***********************************!*\
  !*** ./src/drawer.multicanvas.js ***!
  \***********************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(/*! ./drawer */"./src/drawer.js")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=n?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(r(/*! ./util */"./src/util/index.js")),s=o(r(/*! ./drawer.canvasentry */"./src/drawer.canvasentry.js"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function o(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,d(t).call(this,e,r))).maxCanvasWidth=r.maxCanvasWidth,n.maxCanvasElementWidth=Math.round(r.maxCanvasWidth/r.pixelRatio),n.hasProgressCanvas=r.waveColor!=r.progressColor,n.halfPixel=.5/r.pixelRatio,n.canvases=[],n.progressWave=null,n.EntryClass=s.default,n.canvasContextAttributes=r.drawingContextAttributes,n.overlap=2*Math.ceil(r.pixelRatio/2),n.barRadius=r.barRadius||0,n}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),r=t,(n=[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"})),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var e=this,t=Math.round(this.width/this.params.pixelRatio),r=Math.ceil(t/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<r;)this.addCanvas();for(;this.canvases.length>r;)this.removeCanvas();var n=this.maxCanvasWidth+this.overlap,i=this.canvases.length-1;this.canvases.forEach((function(t,r){r==i&&(n=e.width-e.maxCanvasWidth*i),e.updateDimensions(t,n,e.height),t.clearWave()}))}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.canvasContextAttributes=this.canvasContextAttributes,e.hasProgressCanvas=this.hasProgressCanvas,e.halfPixel=this.halfPixel;var t=this.maxCanvasElementWidth*this.canvases.length;e.initWave(this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}))),this.hasProgressCanvas&&e.initProgress(this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%"}))),this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress),e&&(e.destroy(),e=null),this.canvases.pop()}},{key:"updateDimensions",value:function(e,t,r){var n=Math.round(t/this.params.pixelRatio),i=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(n,i,t,r),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){this.canvases.forEach((function(e){return e.clearWave()}))}},{key:"drawBars",value:function(e,t,r,n){var i=this;return this.prepareDraw(e,t,r,n,(function(e){var t=e.absmax,s=e.hasMinVals,a=(e.height,e.offsetY),o=e.halfH,c=e.peaks;if(void 0!==r)for(var u=s?2:1,l=c.length/u,d=i.params.barWidth*i.params.pixelRatio,h=d+(null===i.params.barGap?Math.max(i.params.pixelRatio,~~(d/2)):Math.max(i.params.pixelRatio,i.params.barGap*i.params.pixelRatio)),f=l/i.width,p=n,m=r;m<p;m+=h){var v=c[Math.floor(m*f*u)]||0,g=Math.round(v/t*o);0==g&&i.params.barMinHeight&&(g=i.params.barMinHeight),i.fillRect(m+i.halfPixel,o-g+a,d+i.halfPixel,2*g,i.barRadius)}}))}},{key:"drawWave",value:function(e,t,r,n){var i=this;return this.prepareDraw(e,t,r,n,(function(e){var t=e.absmax,s=e.hasMinVals,a=(e.height,e.offsetY),o=e.halfH,c=e.peaks;if(!s){for(var u=[],l=c.length,d=0;d<l;d++)u[2*d]=c[d],u[2*d+1]=-c[d];c=u}void 0!==r&&i.drawLine(c,t,o,a,r,n),i.fillRect(0,o+a-i.halfPixel,i.width,i.halfPixel,i.barRadius)}))}},{key:"drawLine",value:function(e,t,r,n,i,s){var a=this;this.canvases.forEach((function(o){a.setFillStyles(o),o.drawLines(e,t,r,n,i,s)}))}},{key:"fillRect",value:function(e,t,r,n,i){for(var s=Math.floor(e/this.maxCanvasWidth),a=Math.min(Math.ceil((e+r)/this.maxCanvasWidth)+1,this.canvases.length),o=s;o<a;o++){var c=this.canvases[o],u=o*this.maxCanvasWidth,l={x1:Math.max(e,o*this.maxCanvasWidth),y1:t,x2:Math.min(e+r,o*this.maxCanvasWidth+c.wave.width),y2:t+n};l.x1<l.x2&&(this.setFillStyles(c),c.fillRects(l.x1-u,l.y1,l.x2-l.x1,l.y2-l.y1,i))}}},{key:"prepareDraw",value:function(e,t,r,n,s){var a=this;return i.frame((function(){if(e[0]instanceof Array){var o=e;if(a.params.splitChannels)return a.setHeight(o.length*a.params.height*a.params.pixelRatio),o.forEach((function(e,t){return a.prepareDraw(e,t,r,n,s)}));e=o[0]}var c=1/a.params.barHeight;if(a.params.normalize){var u=i.max(e),l=i.min(e);c=-l>u?-l:u}var d=[].some.call(e,(function(e){return e<0})),h=a.params.height*a.params.pixelRatio;return s({absmax:c,hasMinVals:d,height:h,offsetY:h*t||0,halfH:h/2,peaks:e})}))()}},{key:"setFillStyles",value:function(e){e.setFillStyles(this.params.waveColor,this.params.progressColor)}},{key:"getImage",value:function(e,t,r){if("blob"===r)return Promise.all(this.canvases.map((function(n){return n.getImage(e,t,r)})));if("dataURL"===r){var n=this.canvases.map((function(n){return n.getImage(e,t,r)}));return n.length>1?n:n[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}])&&u(r.prototype,n),a&&u(r,a),t}(n.default);t.default=f,e.exports=t.default},"./src/mediaelement-webaudio.js":
/*!**************************************!*\
  !*** ./src/mediaelement-webaudio.js ***!
  \**************************************/
/*! no static exports found */function(e,t,r){"use strict";var n;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e,t,r){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=a(this,c(t).call(this,e))).params=e,r.sourceMediaElement=null,r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(n=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(e,r){o(c(t.prototype),"_load",this).call(this,e,r),this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e),this.sourceMediaElement.connect(this.analyser)}}])&&s(r.prototype,n),i&&s(r,i),t}(((n=r(/*! ./mediaelement */"./src/mediaelement.js"))&&n.__esModule?n:{default:n}).default);t.default=l,e.exports=t.default},"./src/mediaelement.js":
/*!*****************************!*\
  !*** ./src/mediaelement.js ***!
  \*****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(/*! ./webaudio */"./src/webaudio.js"))&&n.__esModule?n:{default:n},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=n?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(r(/*! ./util */"./src/util/index.js"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e,t,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=u(this,d(t).call(this,e))).params=e,r.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},r.mediaType=e.mediaType.toLowerCase(),r.elementPosition=e.elementPosition,r.peaks=null,r.playbackRate=1,r.volume=1,r.isMuted=!1,r.buffer=null,r.onPlayEnd=null,r.mediaListeners={},r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),r=t,(n=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")},this.mediaListeners.canplay=function(){e.fireEvent("canplay")},this.mediaListeners.ended=function(){e.fireEvent("finish")},this.mediaListeners.play=function(){e.fireEvent("play")},this.mediaListeners.pause=function(){e.fireEvent("pause")},this.mediaListeners.seeked=function(t){e.fireEvent("seek")},this.mediaListeners.volumechange=function(t){e.isMuted=e.media.muted,e.isMuted?e.volume=0:e.volume=e.media.volume,e.fireEvent("volume")},Object.keys(this.mediaListeners).forEach((function(t){e.media.removeEventListener(t,e.mediaListeners[t]),e.media.addEventListener(t,e.mediaListeners[t])}))}},{key:"createTimer",value:function(){var e=this;this.on("play",(function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime()),s.frame(t)())})),this.on("pause",(function(){e.fireEvent("audioprocess",e.getCurrentTime())}))}},{key:"load",value:function(e,t,r,n){var i=document.createElement(this.mediaType);i.controls=this.params.mediaControls,i.autoplay=this.params.autoplay||!1,i.preload=null==n?"auto":n,i.src=e,i.style.width="100%";var s=t.querySelector(this.mediaType);s&&t.removeChild(s),t.appendChild(i),this._load(i,r)}},{key:"loadElt",value:function(e,t){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e,t)}},{key:"_load",value:function(e,t){if(!(e instanceof HTMLMediaElement)||void 0===e.addEventListener)throw new Error("media parameter is not a valid media element");"function"==typeof e.load&&e.load(),this.media=e,this._setupMediaListeners(),this.peaks=t,this.onPlayEnd=null,this.buffer=null,this.isMuted=e.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var e=(this.buffer||this.media).duration;return e>=1/0&&(e=this.media.seekable.end(0)),e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null!=e&&(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e);var r=this.media.play();return t&&this.setPlayEnd(t),r}},{key:"pause",value:function(){var e;return this.media&&(e=this.media.pause()),this.clearPlayEnd(),e}},{key:"setPlayEnd",value:function(e){var t=this;this.clearPlayEnd(),this._onPlayEnd=function(r){r>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,r,n){return this.buffer?l(d(t.prototype),"getPeaks",this).call(this,e,r,n):this.peaks||[]}},{key:"setSinkId",value:function(e){return e?this.media.setSinkId?this.media.setSinkId(e):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"destroy",value:function(){var e=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach((function(t){e.media&&e.media.removeEventListener(t,e.mediaListeners[t])})),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}])&&c(r.prototype,n),i&&c(r,i),t}(i.default);t.default=f,e.exports=t.default},"./src/peakcache.js":
/*!**************************!*\
  !*** ./src/peakcache.js ***!
  \**************************/
/*! no static exports found */function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clearPeakCache()}var t,r,i;return t=e,(r=[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,t,r){e!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=e);for(var n=[],i=0;i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<t;)i++;for(i%2==0&&n.push(t);i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<=r;)n.push(this.peakCacheRanges[i]),i++;i%2==0&&n.push(r),n=n.filter((function(e,t,r){return 0==t?e!=r[t+1]:t==r.length-1?e!=r[t-1]:e!=r[t-1]&&e!=r[t+1]})),this.peakCacheRanges=this.peakCacheRanges.concat(n),this.peakCacheRanges=this.peakCacheRanges.sort((function(e,t){return e-t})).filter((function(e,t,r){return 0==t?e!=r[t+1]:t==r.length-1?e!=r[t-1]:e!=r[t-1]&&e!=r[t+1]}));var s=[];for(i=0;i<n.length;i+=2)s.push([n[i],n[i+1]]);return s}},{key:"getCacheRanges",value:function(){var e,t=[];for(e=0;e<this.peakCacheRanges.length;e+=2)t.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return t}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i,e.exports=t.default},"./src/util/ajax.js":
/*!**************************!*\
  !*** ./src/util/ajax.js ***!
  \**************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new i.default,r=new XMLHttpRequest,n=!1;return r.open(e.method||"GET",e.url,!0),r.responseType=e.responseType||"json",e.xhr&&(e.xhr.requestHeaders&&e.xhr.requestHeaders.forEach((function(e){r.setRequestHeader(e.key,e.value)})),e.xhr.withCredentials&&(r.withCredentials=!0)),r.addEventListener("progress",(function(e){t.fireEvent("progress",e),e.lengthComputable&&e.loaded==e.total&&(n=!0)})),r.addEventListener("load",(function(e){n||t.fireEvent("progress",e),t.fireEvent("load",e),200==r.status||206==r.status?t.fireEvent("success",r.response,e):t.fireEvent("error",e)})),r.addEventListener("error",(function(e){return t.fireEvent("error",e)})),r.send(),t.xhr=r,t};var n,i=(n=r(/*! ./observer */"./src/util/observer.js"))&&n.__esModule?n:{default:n};e.exports=t.default},"./src/util/extend.js":
/*!****************************!*\
  !*** ./src/util/extend.js ***!
  \****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){console.warn("util.extend is deprecated; use Object.assign instead");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.forEach((function(t){Object.keys(t).forEach((function(r){e[r]=t[r]}))})),e},e.exports=t.default},"./src/util/fetch.js":
/*!***************************!*\
  !*** ./src/util/fetch.js ***!
  \***************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)throw new Error("fetch options missing");if(!e.url)throw new Error("fetch url missing");var t=new i.default,r=new Headers,n=new Request(e.url);t.controller=new AbortController,e&&e.requestHeaders&&e.requestHeaders.forEach((function(e){r.append(e.key,e.value)}));var s=e.responseType||"json",o={method:e.method||"GET",headers:r,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:t.controller.signal};return fetch(n,o).then((function(e){t.response=e;var r=!0;e.body||(r=!1);var n=e.headers.get("content-length");return null===n&&(r=!1),r?(t.onProgress=function(e){t.fireEvent("progress",e)},new Response(new ReadableStream(new a(t,n,e)),o)):e})).then((function(e){var t;if(e.ok)switch(s){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:t="Unknown responseType: "+s}throw t||(t="HTTP error status: "+e.status),new Error(t)})).then((function(e){t.fireEvent("success",e)})).catch((function(e){t.fireEvent("error",e)})),t.fetchRequest=n,t};var n,i=(n=r(/*! ./observer */"./src/util/observer.js"))&&n.__esModule?n:{default:n};function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.instance._reader=n.body.getReader(),this.total=parseInt(r,10),this.loaded=0}var t,r,n;return t=e,(r=[{key:"start",value:function(e){var t=this;!function r(){t.instance._reader.read().then((function(n){var i=n.done,s=n.value;if(i)return 0===t.total&&t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!1}),void e.close();t.loaded+=s.byteLength,t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!(0===t.total)}),e.enqueue(s),r()})).catch((function(t){e.error(t)}))}()}}])&&s(t.prototype,r),n&&s(t,n),e}();e.exports=t.default},"./src/util/frame.js":
/*!***************************!*\
  !*** ./src/util/frame.js ***!
  \***************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(0,i.default)((function(){return e.apply(void 0,r)}))}};var n,i=(n=r(/*! ./request-animation-frame */"./src/util/request-animation-frame.js"))&&n.__esModule?n:{default:n};e.exports=t.default},"./src/util/get-id.js":
/*!****************************!*\
  !*** ./src/util/get-id.js ***!
  \****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e="wavesurfer_"),e+Math.random().toString(32).substring(2)},e.exports=t.default},"./src/util/index.js":
/*!***************************!*\
  !*** ./src/util/index.js ***!
  \***************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ajax",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"getId",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"max",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"min",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"Observer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"extend",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"style",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"requestAnimationFrame",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"preventClick",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"fetchFile",{enumerable:!0,get:function(){return p.default}});var n=m(r(/*! ./ajax */"./src/util/ajax.js")),i=m(r(/*! ./get-id */"./src/util/get-id.js")),s=m(r(/*! ./max */"./src/util/max.js")),a=m(r(/*! ./min */"./src/util/min.js")),o=m(r(/*! ./observer */"./src/util/observer.js")),c=m(r(/*! ./extend */"./src/util/extend.js")),u=m(r(/*! ./style */"./src/util/style.js")),l=m(r(/*! ./request-animation-frame */"./src/util/request-animation-frame.js")),d=m(r(/*! ./frame */"./src/util/frame.js")),h=m(r(/*! debounce */"./node_modules/debounce/index.js")),f=m(r(/*! ./prevent-click */"./src/util/prevent-click.js")),p=m(r(/*! ./fetch */"./src/util/fetch.js"));function m(e){return e&&e.__esModule?e:{default:e}}},"./src/util/max.js":
/*!*************************!*\
  !*** ./src/util/max.js ***!
  \*************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=-1/0;return Object.keys(e).forEach((function(r){e[r]>t&&(t=e[r])})),t},e.exports=t.default},"./src/util/min.js":
/*!*************************!*\
  !*** ./src/util/min.js ***!
  \*************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Number(1/0);return Object.keys(e).forEach((function(r){e[r]<t&&(t=e[r])})),t},e.exports=t.default},"./src/util/observer.js":
/*!******************************!*\
  !*** ./src/util/observer.js ***!
  \******************************/
/*! no static exports found */function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handlers=null}var t,r,i;return t=e,(r=[{key:"on",value:function(e,t){var r=this;this.handlers||(this.handlers={});var n=this.handlers[e];return n||(n=this.handlers[e]=[]),n.push(t),{name:e,callback:t,un:function(e,t){return r.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var r,n=this.handlers[e];if(n)if(t)for(r=n.length-1;r>=0;r--)n[r]==t&&n.splice(r,1);else n.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var r=this;return this.on(e,(function n(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];t.apply(r,s),setTimeout((function(){r.un(e,n)}),0)}))}},{key:"fireEvent",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(this.handlers){var i=this.handlers[e];i&&i.forEach((function(e){e.apply(void 0,r)}))}}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i,e.exports=t.default},"./src/util/prevent-click.js":
/*!***********************************!*\
  !*** ./src/util/prevent-click.js ***!
  \***********************************/
/*! no static exports found */function(e,t,r){"use strict";function n(e){e.stopPropagation(),document.body.removeEventListener("click",n,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){document.body.addEventListener("click",n,!0)},e.exports=t.default},"./src/util/request-animation-frame.js":
/*!*********************************************!*\
  !*** ./src/util/request-animation-frame.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return setTimeout(e,1e3/60)}).bind(window);t.default=n,e.exports=t.default},"./src/util/style.js":
/*!***************************!*\
  !*** ./src/util/style.js ***!
  \***************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Object.keys(t).forEach((function(r){e.style[r]!==t[r]&&(e.style[r]=t[r])})),e},e.exports=t.default},"./src/wavesurfer.js":
/*!***************************!*\
  !*** ./src/wavesurfer.js ***!
  \***************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==d(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=n?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(r(/*! ./util */"./src/util/index.js")),i=u(r(/*! ./drawer.multicanvas */"./src/drawer.multicanvas.js")),s=u(r(/*! ./webaudio */"./src/webaudio.js")),a=u(r(/*! ./mediaelement */"./src/mediaelement.js")),o=u(r(/*! ./peakcache */"./src/peakcache.js")),c=u(r(/*! ./mediaelement-webaudio */"./src/mediaelement-webaudio.js"));function u(e){return e&&e.__esModule?e:{default:e}}function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?p(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),e}var w=function(e){function t(e){var r;if(v(this,t),(r=h(this,f(t).call(this))).defaultParams={audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!0},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:i.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#999",xhr:{}},r.backends={MediaElement:a.default,WebAudio:s.default,MediaElementWebAudio:c.default},r.util=n,r.params=Object.assign({},r.defaultParams,e),r.container="string"==typeof e.container?document.querySelector(r.params.container):r.params.container,!r.container)throw new Error("Container element not found");if(null==r.params.mediaContainer?r.mediaContainer=r.container:"string"==typeof r.params.mediaContainer?r.mediaContainer=document.querySelector(r.params.mediaContainer):r.mediaContainer=r.params.mediaContainer,!r.mediaContainer)throw new Error("Media Container element not found");if(r.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(r.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(!0===r.params.rtl&&n.style(r.container,{transform:"rotateY(180deg)"}),r.params.backgroundColor&&r.setBackgroundColor(r.params.backgroundColor),r.savedVolume=0,r.isMuted=!1,r.tmpEvents=[],r.currentRequest=null,r.arraybuffer=null,r.drawer=null,r.backend=null,r.peakCache=null,"function"!=typeof r.params.renderer)throw new Error("Renderer parameter is invalid");r.Drawer=r.params.renderer,"AudioElement"==r.params.backend&&(r.params.backend="MediaElement"),"WebAudio"!=r.params.backend&&"MediaElementWebAudio"!==r.params.backend||s.default.prototype.supportsWebAudio.call(null)||(r.params.backend="MediaElement"),r.Backend=r.backends[r.params.backend],r.initialisedPluginList={},r.isDestroyed=!1,r.isReady=!1;var o=0;return r._onResize=n.debounce((function(){o==r.drawer.wrapper.clientWidth||r.params.scrollParent||(o=r.drawer.wrapper.clientWidth,r.drawer.fireEvent("redraw"))}),"number"==typeof r.params.responsive?r.params.responsive:100),h(r,p(r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),y(t,null,[{key:"create",value:function(e){return new t(e).init()}}]),y(t,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach((function(e){return t.addPlugin(e)})),e.forEach((function(e){e.deferInit||t.initPlugin(e.name)})),this.fireEvent("plugins-registered",e),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach((function(r){t[r]=e.staticProps[r]}));var r=e.instance;return Object.getOwnPropertyNames(n.Observer.prototype).forEach((function(e){r.prototype[e]=n.Observer.prototype[e]})),this[e.name]=new r(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!=typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach((function(t){return e.destroyPlugin(t)}))}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",(function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())})),this.drawer.on("click",(function(t,r){setTimeout((function(){return e.seekTo(r)}),0)})),this.drawer.on("scroll",(function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)}))}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",(function(){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("finish")})),this.backend.on("play",(function(){return e.fireEvent("play")})),this.backend.on("pause",(function(){return e.fireEvent("pause")})),this.backend.on("audioprocess",(function(t){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",t)})),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",(function(){e.drawer.progress(e.backend.getPlayedPercents())})),this.backend.on("volume",(function(){var t=e.getVolume();e.fireEvent("volume",t),e.backend.isMuted!==e.isMuted&&(e.isMuted=e.backend.isMuted,e.fireEvent("mute",e.isMuted))})))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new o.default)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){e>=this.getDuration()?this.seekTo(1):this.seekTo(e/this.getDuration())}},{key:"play",value:function(e,t){var r=this;return this.fireEvent("interaction",(function(){return r.play(e,t)})),this.backend.play(e,t)}},{key:"setPlayEnd",value:function(e){this.backend.setPlayEnd(e)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,r=this.getCurrentTime()||0;r=Math.max(0,Math.min(t,r+(e||0))),this.seekAndCenter(r/t)}},{key:"seekAndCenter",value:function(e){this.seekTo(e),this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var t=this;if("number"!=typeof e||!isFinite(e)||e<0||e>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",(function(){return t.seekTo(e)}));var r=this.backend.isPaused();r||this.backend.pause();var n=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(e*this.getDuration()),this.drawer.progress(e),r||this.backend.play(),this.params.scrollParent=n,this.fireEvent("seek",e)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){this.backend.setVolume(e),this.fireEvent("volume",e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted?(e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)):this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){return this.params.waveColor}},{key:"setWaveColor",value:function(e){this.params.waveColor=e,this.drawBuffer()}},{key:"getProgressColor",value:function(){return this.params.progressColor}},{key:"setProgressColor",value:function(e){this.params.progressColor=e,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e,n.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e,this.drawer.setHeight(e*this.params.pixelRatio),this.drawBuffer()}},{key:"drawBuffer",value:function(){var e,t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),r=this.drawer.getWidth(),n=t,i=0,s=Math.max(i+r,n);if(this.params.fillParent&&(!this.params.scrollParent||t<r)&&(i=0,s=n=r),this.params.partialRender){var a,o=this.peakCache.addRangeToPeakCache(n,i,s);for(a=0;a<o.length;a++)e=this.backend.getPeaks(n,o[a][0],o[a][1]),this.drawer.drawPeaks(e,n,o[a][0],o[a][1])}else e=this.backend.getPeaks(n,i,s),this.drawer.drawPeaks(e,n,i,s);this.fireEvent("redraw",e,n)}},{key:"zoom",value:function(e){e?(this.params.minPxPerSec=e,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,(function(e){t.isDestroyed||t.loadDecodedBuffer(e)}))}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var t=this,r=new FileReader;r.addEventListener("progress",(function(e){return t.onProgress(e)})),r.addEventListener("load",(function(e){return t.loadArrayBuffer(e.target.result)})),r.addEventListener("error",(function(){return t.fireEvent("error","Error reading file")})),r.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t,r,n){if(!e)throw new Error("url parameter cannot be empty");if(this.empty(),r){var i={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(r),"Peaks are not provided":!t,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof e},s=Object.keys(i).filter((function(e){return i[e]}));s.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+s.join("\n\t- ")),r=null)}switch(this.params.backend){case"WebAudio":return this.loadBuffer(e,t,n);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,t,r,n)}}},{key:"loadBuffer",value:function(e,t,r){var n=this,i=function(t){return t&&n.tmpEvents.push(n.once("ready",t)),n.getArrayBuffer(e,(function(e){return n.loadArrayBuffer(e)}))};if(!t)return i();this.backend.setPeaks(t,r),this.drawBuffer(),this.tmpEvents.push(this.once("interaction",i))}},{key:"loadMediaElement",value:function(e,t,r,n){var i=this,s=e;if("string"==typeof e)this.backend.load(s,this.mediaContainer,t,r);else{var a=e;this.backend.loadElt(a,t),s=a.src}this.tmpEvents.push(this.backend.once("canplay",(function(){i.backend.destroyed||(i.drawBuffer(),i.isReady=!0,i.fireEvent("ready"))})),this.backend.once("error",(function(e){return i.fireEvent("error",e)}))),t&&this.backend.setPeaks(t,n),t&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(s,(function(e){i.decodeArrayBuffer(e,(function(e){i.backend.buffer=e,i.backend.setPeaks(null),i.drawBuffer(),i.fireEvent("waveform-ready")}))}))}},{key:"decodeArrayBuffer",value:function(e,t){var r=this;this.arraybuffer=e,this.backend.decodeArrayBuffer(e,(function(n){r.isDestroyed||r.arraybuffer!=e||(t(n),r.arraybuffer=null)}),(function(){return r.fireEvent("error","Error decoding audiobuffer")}))}},{key:"getArrayBuffer",value:function(e,t){var r=this,i=Object.assign({url:e,responseType:"arraybuffer"},this.params.xhr),s=n.fetchFile(i);return this.currentRequest=s,this.tmpEvents.push(s.on("progress",(function(e){r.onProgress(e)})),s.on("success",(function(e){t(e),r.currentRequest=null})),s.on("error",(function(e){r.fireEvent("error",e),r.currentRequest=null}))),s}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"exportPCM",value:function(e,t,r,n,i){e=e||1024,n=n||0,t=t||1e4,r=r||!1;var s=this.backend.getPeaks(e,n,i),a=[].map.call(s,(function(e){return Math.round(e*t)/t}));return new Promise((function(e,t){var n=JSON.stringify(a);r||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(n)),e(n)}))}},{key:"exportImage",value:function(e,t,r){return e||(e="image/png"),t||(t=1),r||(r="dataURL"),this.drawer.getImage(e,t,r)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach((function(e){return e.un()}))}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&this.backend.destroy(),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}]),t}(n.Observer);t.default=w,w.VERSION="3.3.0",w.util=n,e.exports=t.default},"./src/webaudio.js":
/*!*************************!*\
  !*** ./src/webaudio.js ***!
  \*************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}(r(/*! ./util */"./src/util/index.js"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(e){var r,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=o(this,c(t).call(this))).audioContext=null,i.offlineAudioContext=null,i.stateBehaviors=(a(r={},"playing",{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),a(r,"paused",{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),a(r,"finished",{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),r),i.params=e,i.ac=e.audioContext||(i.supportsWebAudio()?i.getAudioContext():{}),i.lastPlay=i.ac.currentTime,i.startPosition=0,i.scheduledPause=null,i.states=(a(n={},"playing",Object.create(i.stateBehaviors.playing)),a(n,"paused",Object.create(i.stateBehaviors.paused)),a(n,"finished",Object.create(i.stateBehaviors.finished)),n),i.buffer=null,i.filters=[],i.gainNode=null,i.mergedPeaks=null,i.offlineAc=null,i.peaks=null,i.playbackRate=1,i.analyser=null,i.scriptNode=null,i.source=null,i.splitPeaks=[],i.state=null,i.explicitDuration=e.duration,i.destroyed=!1,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),l(t,[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.WaveSurferOfflineAudioContext}}]),l(t,[{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState("paused"),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach((function(e){e&&e.disconnect()})),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce((function(e,t){return e.connect(t),t}),this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor?this.scriptNode=this.params.audioScriptProcessor:this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(t.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(t.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var t=e.getCurrentTime();t>=e.getDuration()?(e.setState("finished"),e.fireEvent("pause")):t>=e.scheduledPause?e.pause():e.state===e.states.playing&&e.fireEvent("audioprocess",t)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=function(){}}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){if(e){var t=new window.Audio;if(!t.setSinkId)return Promise.reject(new Error("setSinkId is not supported in your browser"));t.autoplay=!0;var r=this.ac.createMediaStreamDestination();return this.gainNode.disconnect(),this.gainNode.connect(r),t.srcObject=r.stream,t.setSinkId(e)}return Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,r){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(e,(function(e){return t(e)}),r)}},{key:"setPeaks",value:function(e,t){null!=t&&(this.explicitDuration=t),this.peaks=e}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var t,r=this.buffer?this.buffer.numberOfChannels:1;for(t=0;t<r;t++)this.splitPeaks[t]=[],this.splitPeaks[t][2*(e-1)]=0,this.splitPeaks[t][2*(e-1)+1]=0;this.mergedPeaks[2*(e-1)]=0,this.mergedPeaks[2*(e-1)+1]=0}}},{key:"getPeaks",value:function(e,t,r){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(t=t||0,r=r||e-1,this.setLength(e),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var n=this.createBuffer(1,4096,this.sampleRate);this.buffer=n.buffer}var i,s=this.buffer.length/e,a=~~(s/10)||1,o=this.buffer.numberOfChannels;for(i=0;i<o;i++){var c=this.splitPeaks[i],u=this.buffer.getChannelData(i),l=void 0;for(l=t;l<=r;l++){var d=~~(l*s),h=~~(d+s),f=0,p=0,m=void 0;for(m=d;m<h;m+=a){var v=u[m];v>p&&(p=v),v<f&&(f=v)}c[2*l]=p,c[2*l+1]=f,(0==i||p>this.mergedPeaks[2*l])&&(this.mergedPeaks[2*l]=p),(0==i||f<this.mergedPeaks[2*l+1])&&(this.mergedPeaks[2*l+1]=f)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null)}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states.playing}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime())>=this.getDuration()&&(e=0),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states.finished&&this.setState("paused"),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var r=this.seekTo(e,t);e=r.start,t=r.end,this.scheduledPause=t,this.source.start(0,e),"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume(),this.setState("playing"),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState("paused"),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){e=e||1,this.isPaused()?this.playbackRate=e:(this.pause(),this.playbackRate=e,this.play())}},{key:"setPlayEnd",value:function(e){this.scheduledPause=e}}]),t}(n.Observer);t.default=h,h.scriptBufferSize=256,e.exports=t.default}})},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=r(18);t.KeywordCxt=n.default;var i=r(1);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return i._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return i.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return i.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return i.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return i.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return i.CodeGen}});const s=r(41),a=r(43),o=r(76),c=["/properties"],u="http://json-schema.org/draft-07/schema";class l extends s.default{_addVocabularies(){super._addVocabularies(),a.default.forEach(e=>this.addVocabulary(e))}_addDefaultMetaSchema(){super._addDefaultMetaSchema();const{$data:e,meta:t}=this.opts;if(!t)return;const r=e?this.$dataMetaSchema(o,c):o;this.addMetaSchema(r,u,!1),this.refs["http://json-schema.org/schema"]=u}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(u)?u:void 0)}}t.default=l},function(e,t,r){r(25),r(24),r(26),e.exports=r(77)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;const n=r(19),i=r(1),s=r(6),a={message:"boolean schema is false"};function o(e,t){const{gen:r,data:i}=e,s={gen:r,keyword:"false schema",data:i,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};n.reportError(s,a,t)}t.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?o(e,!1):"object"==typeof r&&!0===r.$async?t.return(s.default.data):(t.assign(i._`${n}.errors`,null),t.return(!0))},t.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),o(e)):r.var(t,!0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schemaKeywords=void 0;const n=r(28),i=r(9),s=r(38),a=r(9),o=r(39),c=r(3),u=r(4),l=r(1),d=r(6);function h(e,t){const{gen:r,schema:i,opts:{useDefaults:a}}=e;a&&s.assignDefaults(e,t.type),r.block(()=>{for(const r of t.rules)n.shouldUseRule(i,r)&&o.keywordCode(e,r.keyword,r.definition,t.type)})}function f(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function p(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,u.checkStrictMode(e,t,e.opts.strictTypes)}t.schemaKeywords=function(e,t,r,s){const{gen:u,schema:m,data:v,allErrors:g,opts:y,self:w}=e,{RULES:b}=w;function _(o){n.shouldUseGroup(m,o)&&(o.type?(u.if(i.checkDataType(o.type,v,y.strict)),h(e,o),1===t.length&&t[0]===o.type&&r&&(u.else(),a.reportTypeError(e)),u.endIf()):h(e,o),g||u.if(l._`${d.default.errors} === ${s||0}`))}!m.$ref||!y.ignoreKeywordsWithRef&&c.schemaHasRulesButRef(m,b)?(!function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(t=>{f(e.dataTypes,t)||p(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(e=>f(t,e))})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&p(e,"use allowUnionTypes to allow union type keyword")}(e,t);!function(e,t){const r=e.self.RULES.all;for(const i in r){const s=r[i];if("object"==typeof s&&n.shouldUseRule(e.schema,s)){const{type:r}=s.definition;r.length&&!r.some(e=>{return n=e,(r=t).includes(n)||"number"===n&&r.includes("integer");var r,n})&&p(e,`missing type "${r.join(",")}" for keyword "${i}"`)}}}(e,e.dataTypes)}(e,t),u.block(()=>{for(const e of b.rules)_(e);_(b.post)})):u.block(()=>o.keywordCode(e,"$ref",b.all.$ref.definition))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const n=r(1),i=r(4);function s(e,t,r){const{gen:s,compositeRule:a,data:o,opts:c}=e;if(void 0===r)return;const u=n._`${o}${n.getProperty(t)}`;if(a)return void i.checkStrictMode(e,"default is ignored for: "+u);let l=n._`${u} === undefined`;"empty"===c.useDefaults&&(l=n._`${l} || ${u} === null || ${u} === ""`),s.if(l,n._`${u} = ${n.stringify(r)}`)}t.assignDefaults=function(e,t){const{properties:r,items:n}=e.schema;if("object"===t&&r)for(const t in r)s(e,t,r[t].default);else"array"===t&&Array.isArray(n)&&n.forEach((t,r)=>s(e,r,t.default))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keywordCode=void 0;const n=r(18),i=r(19),s=r(8),a=r(1),o=r(6);function c(e,t){var r;const{gen:n,keyword:c,schema:d,parentSchema:h,$data:f,it:p}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(p,t);const m=!f&&t.compile?t.compile.call(p.self,d,h,p):t.validate,v=l(n,c,m),g=n.let("valid");function y(r=(t.async?a._`await `:a.nil)){const i=p.opts.passContext?o.default.this:o.default.self,c=!("compile"in t&&!f||!1===t.schema);n.assign(g,a._`${r}${s.callValidateCode(e,v,i,c)}`,t.modifying)}function w(e){var r;n.if(a.not(null!==(r=t.valid)&&void 0!==r?r:g),e)}e.block$data(g,(function(){if(!1===t.errors)y(),t.modifying&&u(e),w(()=>e.error());else{const r=t.async?function(){const e=n.let("ruleErrs",null);return n.try(()=>y(a._`await `),t=>n.assign(g,!1).if(a._`${t} instanceof ${p.ValidationError}`,()=>n.assign(e,a._`${t}.errors`),()=>n.throw(t))),e}():function(){const e=a._`${v}.errors`;return n.assign(e,null),y(a.nil),e}();t.modifying&&u(e),w(()=>function(e,t){const{gen:r}=e;r.if(a._`Array.isArray(${t})`,()=>{r.assign(o.default.vErrors,a._`${o.default.vErrors} === null ? ${t} : ${o.default.vErrors}.concat(${t})`).assign(o.default.errors,a._`${o.default.vErrors}.length`),i.extendErrors(e)},()=>e.error())}(e,r))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:g)}function u(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,()=>t.assign(r,a._`${n.parentData}[${n.parentDataProperty}]`))}function l(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:a.stringify(r)})}t.keywordCode=function(e,t,r,i){const s=new n.default(e,r,t);"code"in r?r.code(s,i):s.$data&&r.validate?c(s,r):"macro"in r?function(e,t){const{gen:r,keyword:n,schema:i,parentSchema:s,it:o}=e,c=t.macro.call(o.self,i,s,o),u=l(r,n,c);!1!==o.opts.validateSchema&&o.self.validateSchema(c,!0);const d=r.name("valid");e.subschema({schema:c,schemaPath:a.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:u,compositeRule:!0},d),e.pass(d,()=>e.error(!0))}(s,r):(r.compile||r.validate)&&c(s,r)}},function(e,t,r){"use strict";var n=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,i,s,a,o,c,u,l,d){if(s&&"object"==typeof s&&!Array.isArray(s)){for(var h in r(s,a,o,c,u,l,d),s){var f=s[h];if(Array.isArray(f)){if(h in n.arrayKeywords)for(var p=0;p<f.length;p++)e(t,r,i,f[p],a+"/"+h+"/"+p,o,a,h,s,p)}else if(h in n.propsKeywords){if(f&&"object"==typeof f)for(var m in f)e(t,r,i,f[m],a+"/"+h+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),o,a,h,s,m)}else(h in n.keywords||t.allKeys&&!(h in n.skipKeywords))&&e(t,r,i,f,a+"/"+h,o,a,h,s)}i(s,a,o,c,u,l,d)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};n.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},n.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},n.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},n.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=r(18);t.KeywordCxt=n.default;var i=r(1);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return i._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return i.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return i.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return i.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return i.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return i.CodeGen}});const s=r(23),a=r(27),o=r(31),c=r(1),u=r(20),l=r(9),d=r(3),h=r(42),f=["removeAdditional","useDefaults","coerceTypes"],p=new Set(["validate","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),m={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",schemaId:"JSON Schema draft-04 is not supported in Ajv v7.",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",strictNumbers:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key."},v={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function g(e){var t,r,n,i,s,a,o,c,u,l,d,h;const f=null===(t=e.strict)||void 0===t||t,p=!!f&&"log",m=null===(r=e.code)||void 0===r?void 0:r.optimize,v=!0===m||void 0===m?1:m||0;return{strict:f,strictTypes:null!==(n=e.strictTypes)&&void 0!==n?n:p,strictTuples:null!==(i=e.strictTuples)&&void 0!==i?i:p,code:e.code?{...e.code,optimize:v}:{optimize:v},loopRequired:null!==(s=e.loopRequired)&&void 0!==s?s:1/0,loopEnum:null!==(a=e.loopEnum)&&void 0!==a?a:1/0,meta:null===(o=e.meta)||void 0===o||o,messages:null===(c=e.messages)||void 0===c||c,inlineRefs:null===(u=e.inlineRefs)||void 0===u||u,addUsedSchema:null===(l=e.addUsedSchema)||void 0===l||l,validateSchema:null===(d=e.validateSchema)||void 0===d||d,validateFormats:null===(h=e.validateFormats)||void 0===h||h}}class y{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...g(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new c.ValueScope({scope:{},prefixes:p,es5:t,lines:r}),this.logger=function(e){if(!1===e)return $;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=a.getRules(),w.call(this,m,e,"NOT SUPPORTED"),w.call(this,v,e,"DEPRECATED","warn"),this._metaOpts=P.call(this),e.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&k.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),_.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t}=this.opts;t&&e&&this.addMetaSchema(h,h.$id,!1)}defaultMeta(){const{meta:e}=this.opts;return this.opts.defaultMeta="object"==typeof e?e.$id||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,t){await i.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||a.call(this,r)}async function i(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}async function a(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof s.MissingRefError))throw t;return o.call(this,t),await c.call(this,t.missingSchema),a.call(this,e)}}function o({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function c(e){const r=await u.call(this,e);this.refs[e]||await i.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function u(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let i;if("object"==typeof e&&(i=e.$id,void 0!==i&&"string"!=typeof i))throw new Error("schema id must be string");return t=u.normalizeId(t||i),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=b.call(this,e));)e=t;if(void 0===t){const r=new o.SchemaEnv({schema:{}});if(t=o.resolveSchema.call(this,r,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=b.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e.$id;return r&&(r=u.normalizeId(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(S.call(this,r,t),!t)return d.eachItem(r,e=>x.call(this,e)),this;O.call(this,t);const n={...t,type:l.getJSONTypes(t.type),schemaType:l.getJSONTypes(t.schemaType)};return d.eachItem(r,0===n.type.length?e=>x.call(this,e,n):e=>n.type.forEach(t=>x.call(this,e,n,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.dataPath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let i=e;for(const e of t)i=i[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,s=i[e];n&&s&&(i[e]=T(s))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];t&&!t.test(r)||("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r=this.opts.validateSchema,n=this.opts.addUsedSchema){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema must be object or boolean");let i=this._cache.get(e);if(void 0!==i)return i;const s=u.getSchemaRefs.call(this,e);i=new o.SchemaEnv({schema:e,meta:t,localRefs:s}),this._cache.set(i.schema,i);const a=i.baseId;return n&&!a.startsWith("#")&&(a&&this._checkUnique(a),this.refs[a]=i),r&&this.validateSchema(e,!0),i}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):o.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,e)}finally{this.opts=t}}}function w(e,t,r,n="error"){for(const i in e){const s=i;s in t&&this.logger[n](`${r}: option ${i}. ${e[s]}`)}}function b(e){return e=u.normalizeId(e),this.schemas[e]||this.refs[e]}function _(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function E(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function k(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function P(){const e={...this.opts};for(const t of f)delete e[t];return e}t.default=y,y.ValidationError=s.ValidationError,y.MissingRefError=s.MissingRefError;const $={log(){},warn(){},error(){}};const C=/^[a-z_$][a-z0-9_$-]*$/i;function S(e,t){const{RULES:r}=this;if(d.eachItem(e,e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!C.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function x(e,t,r){var n;const i=null==t?void 0:t.post;if(r&&i)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:s}=this;let a=i?s.post:s.rules.find(({type:e})=>e===r);if(a||(a={type:r,rules:[]},s.rules.push(a)),s.keywords[e]=!0,!t)return;const o={keyword:e,definition:{...t,type:l.getJSONTypes(t.type),schemaType:l.getJSONTypes(t.schemaType)}};t.before?R.call(this,a,o,t.before):a.rules.push(o),s.all[e]=o,null===(n=t.implements)||void 0===n||n.forEach(e=>this.addKeyword(e))}function R(e,t,r){const n=e.rules.findIndex(e=>e.keyword===r);n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function O(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=T(t)),e.validateSchema=this.compile(t,!0))}const j={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function T(e){return{anyOf:[e,j]}}},function(e){e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(44),i=r(47),s=r(59),a=r(73),o=r(75),c=[n.default,i.default,s.default,a.default,o.metadataVocabulary,o.contentVocabulary];t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(45),i=r(46),s=["$schema","$id","$defs","$vocabulary","definitions",n.default,i.default];t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;const n=r(23),i=r(8),s=r(1),a=r(6),o=r(31),c=r(3),u={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:i}=e,{baseId:a,schemaEnv:c,validateName:u,opts:h,self:f}=i;if("#"===r||"#/"===r)return function(){if(c===c.root)return d(e,u,c,c.$async);const r=t.scopeValue("root",{ref:c.root});return d(e,s._`${r}.validate`,c.root,c.root.$async)}();const p=o.resolveRef.call(f,c.root,a,r);if(void 0===p)throw new n.MissingRefError(a,r);return p instanceof o.SchemaEnv?function(t){const r=l(e,t);d(e,r,t,t.$async)}(p):function(n){const i=t.scopeValue("schema",!0===h.code.source?{ref:n,code:s.stringify(n)}:{ref:n}),a=t.name("valid"),o=e.subschema({schema:n,strictSchema:!0,dataTypes:[],schemaPath:s.nil,topSchemaRef:i,errSchemaPath:r},a);e.mergeEvaluated(o),e.ok(a)}(p)}};function l(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):s._`${r.scopeValue("wrapper",{ref:t})}.validate`}function d(e,t,r,n){const{gen:o,it:u}=e,{allErrors:l,schemaEnv:d,opts:h}=u,f=h.passContext?a.default.this:s.nil;function p(e){const t=s._`${e}.errors`;o.assign(a.default.vErrors,s._`${a.default.vErrors} === null ? ${t} : ${a.default.vErrors}.concat(${t})`),o.assign(a.default.errors,s._`${a.default.vErrors}.length`)}function m(e){var t;if(!u.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==u.props)if(n&&!n.dynamicProps)void 0!==n.props&&(u.props=c.mergeEvaluated.props(o,n.props,u.props));else{const t=o.var("props",s._`${e}.evaluated.props`);u.props=c.mergeEvaluated.props(o,t,u.props,s.Name)}if(!0!==u.items)if(n&&!n.dynamicItems)void 0!==n.items&&(u.items=c.mergeEvaluated.items(o,n.items,u.items));else{const t=o.var("items",s._`${e}.evaluated.items`);u.items=c.mergeEvaluated.items(o,t,u.items,s.Name)}}n?function(){if(!d.$async)throw new Error("async schema referenced by sync schema");const r=o.let("valid");o.try(()=>{o.code(s._`await ${i.callValidateCode(e,t,f)}`),m(t),l||o.assign(r,!0)},e=>{o.if(s._`!(${e} instanceof ${u.ValidationError})`,()=>o.throw(e)),p(e),l||o.assign(r,!1)}),e.ok(r)}():e.result(i.callValidateCode(e,t,f),()=>m(t),()=>p(t))}t.getValidate=l,t.callRef=d,t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(48),i=r(49),s=r(50),a=r(52),o=r(53),c=r(54),u=r(55),l=r(56),d=r(57),h=r(58),f=[n.default,i.default,s.default,a.default,o.default,c.default,u.default,l.default,{keyword:"nullable",schemaType:"boolean"},d.default,h.default];t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=n.operators,s={maximum:{okStr:"<=",ok:i.LTE,fail:i.GT},minimum:{okStr:">=",ok:i.GTE,fail:i.LT},exclusiveMaximum:{okStr:"<",ok:i.LT,fail:i.GTE},exclusiveMinimum:{okStr:">",ok:i.GT,fail:i.LTE}},a={message:({keyword:e,schemaCode:t})=>n.str`should be ${s[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>n._`{comparison: ${s[e].okStr}, limit: ${t}}`},o={keyword:Object.keys(s),type:"number",schemaType:"number",$data:!0,error:a,code(e){const{keyword:t,data:r,schemaCode:i}=e;e.fail$data(n._`${r} ${s[t].fail} ${i} || isNaN(${r})`)}};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>n.str`should be multiple of ${e}`,params:({schemaCode:e})=>n._`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:i,it:s}=e,a=s.opts.multipleOfPrecision,o=t.let("res"),c=a?n._`Math.abs(Math.round(${o}) - ${o}) > 1e-${a}`:n._`${o} !== parseInt(${o})`;e.fail$data(n._`(${i} === 0 || (${o} = ${r}/${i}, ${c}))`)}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(51),s={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxLength"===e?"more":"fewer";return n.str`should NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>n._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:s,it:a}=e,o="maxLength"===t?n.operators.GT:n.operators.LT;let c;if(!1===a.opts.unicode)c=n._`${r}.length`;else{const t=e.gen.scopeValue("func",{ref:i.default,code:n._`require("ajv/dist/compile/ucs2length").default`});c=n._`${t}(${r})`}e.fail$data(n._`${c} ${o} ${s}`)}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.length;let r,n=0,i=0;for(;i<t;)n++,r=e.charCodeAt(i++),r>=55296&&r<=56319&&i<t&&(r=e.charCodeAt(i),56320==(64512&r)&&i++);return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(1),s={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>i.str`should match pattern "${e}"`,params:({schemaCode:e})=>i._`{pattern: ${e}}`},code(e){const{gen:t,data:r,$data:s,schema:a,schemaCode:o}=e,c=s?i._`(new RegExp(${o}, "u"))`:n.usePattern(t,a);e.fail$data(i._`!${c}.test(${r})`)}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxProperties"===e?"more":"fewer";return n.str`should NOT have ${r} than ${t} items`},params:({schemaCode:e})=>n._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:i}=e,s="maxProperties"===t?n.operators.GT:n.operators.LT;e.fail$data(n._`Object.keys(${r}).length ${s} ${i}`)}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(1),s={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>i.str`should have required property '${e}'`,params:({params:{missingProperty:e}})=>i._`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:s,data:a,$data:o,it:c}=e,{opts:u}=c;if(!o&&0===r.length)return;const l=r.length>=u.loopRequired;function d(){t.forOf("prop",s,r=>{e.setParams({missingProperty:r}),t.if(n.noPropertyInData(a,r,u.ownProperties),()=>e.error())})}c.allErrors?function(){if(l||o)e.block$data(i.nil,d);else for(const t of r)n.checkReportMissingProp(e,t)}():function(){const c=t.let("missing");if(l||o){const r=t.let("valid",!0);e.block$data(r,()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,s,()=>{t.assign(o,n.propertyInData(a,r,u.ownProperties)),t.if(i.not(o),()=>{e.error(),t.break()})},i.nil)}(c,r)),e.ok(r)}else t.if(n.checkMissingProp(e,r,c)),n.reportMissingProp(e,c),t.else()}()}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxItems"===e?"more":"fewer";return n.str`should NOT have ${r} than ${t} items`},params:({schemaCode:e})=>n._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:i}=e,s="maxItems"===t?n.operators.GT:n.operators.LT;e.fail$data(n._`${r}.length ${s} ${i}`)}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9),i=r(1),s=r(21),a={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>i.str`should NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>i._`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:a,schema:o,parentSchema:c,schemaCode:u,it:l}=e;if(!a&&!o)return;const d=t.let("valid"),h=c.items?n.getSchemaTypes(c.items):[];function f(s,a){const o=t.name("item"),c=n.checkDataTypes(h,o,l.opts.strict,n.DataType.Wrong),u=t.const("indices",i._`{}`);t.for(i._`;${s}--;`,()=>{t.let(o,i._`${r}[${s}]`),t.if(c,i._`continue`),h.length>1&&t.if(i._`typeof ${o} == "string"`,i._`${o} += "_"`),t.if(i._`typeof ${u}[${o}] == "number"`,()=>{t.assign(a,i._`${u}[${o}]`),e.error(),t.assign(d,!1).break()}).code(i._`${u}[${o}] = ${s}`)})}function p(n,a){const o=e.gen.scopeValue("func",{ref:s,code:i._`require("ajv/dist/compile/equal")`}),c=t.name("outer");t.label(c).for(i._`;${n}--;`,()=>t.for(i._`${a} = ${n}; ${a}--;`,()=>t.if(i._`${o}(${r}[${n}], ${r}[${a}])`,()=>{e.error(),t.assign(d,!1).break(c)})))}e.block$data(d,(function(){const n=t.let("i",i._`${r}.length`),s=t.let("j");e.setParams({i:n,j:s}),t.assign(d,!0),t.if(i._`${n} > 1`,()=>(h.length>0&&!h.some(e=>"object"===e||"array"===e)?f:p)(n,s))}),i._`${u} === false`),e.ok(d)}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(21),s={keyword:"const",$data:!0,error:{message:"should be equal to constant",params:({schemaCode:e})=>n._`{allowedValue: ${e}}`},code(e){const t=e.gen.scopeValue("func",{ref:i,code:n._`require("ajv/dist/compile/equal")`});e.fail$data(n._`!${t}(${e.data}, ${e.schemaCode})`)}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(21),s={keyword:"enum",schemaType:"array",$data:!0,error:{message:"should be equal to one of the allowed values",params:({schemaCode:e})=>n._`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:s,schema:a,schemaCode:o,it:c}=e;if(!s&&0===a.length)throw new Error("enum must have non-empty array");const u=a.length>=c.opts.loopEnum,l=e.gen.scopeValue("func",{ref:i,code:n._`require("ajv/dist/compile/equal")`});let d;if(u||s)d=t.let("valid"),e.block$data(d,(function(){t.assign(d,!1),t.forOf("v",o,e=>t.if(n._`${l}(${r}, ${e})`,()=>t.assign(d,!0).break()))}));else{if(!Array.isArray(a))throw new Error("ajv implementation error");const e=t.const("vSchema",o);d=n.or(...a.map((t,i)=>function(e,t){const i=a[t];return i&&"object"==typeof i?n._`${l}(${r}, ${e}[${t}])`:n._`${r} === ${i}`}(e,i)))}e.pass(d)}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(60),i=r(61),s=r(62),a=r(63),o=r(64),c=r(32),u=r(65),l=r(66),d=r(67),h=r(68),f=r(69),p=r(70),m=r(71),v=r(72),g=[d.default,h.default,f.default,p.default,m.default,v.default,n.default,i.default,s.default,o.default,c.default,a.default,u.default,l.default];t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(10),s=r(3),a=r(4),o={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>n.str`should NOT have more than ${e} items`,params:({params:{len:e}})=>n._`{limit: ${e}}`},code(e){const{gen:t,schema:r,parentSchema:o,data:c,it:u}=e,{items:l}=o;if(!Array.isArray(l))return void a.checkStrictMode(u,'"additionalItems" is ignored when "items" is not an array of schemas');u.items=!0;const d=t.const("len",n._`${c}.length`);if(!1===r)e.setParams({len:l.length}),e.pass(n._`${d} <= ${l.length}`);else if("object"==typeof r&&!s.alwaysValidSchema(u,r)){const r=t.var("valid",n._`${d} <= ${l.length}`);t.if(n.not(r),()=>function(r){t.forRange("i",l.length,d,s=>{e.subschema({keyword:"additionalItems",dataProp:s,dataPropType:i.Type.Num},r),u.allErrors||t.if(n.not(r),()=>t.break())})}(r)),e.ok(r)}}};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(10),s=r(3),a=r(4),o={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{gen:t,schema:r,parentSchema:o,data:c,it:u}=e,l=t.const("len",n._`${c}.length`);Array.isArray(r)?(u.opts.unevaluated&&r.length&&!0!==u.items&&(u.items=s.mergeEvaluated.items(t,r.length,u.items)),function(i){if(u.opts.strictTuples&&!function(e,t){return e===t.minItems&&(e===t.maxItems||!1===t.additionalItems)}(r.length,o)){const e=`"items" is ${i.length}-tuple, but minItems or maxItems/additionalItems are not specified or different`;a.checkStrictMode(u,e,u.opts.strictTuples)}const c=t.name("valid");i.forEach((r,i)=>{s.alwaysValidSchema(u,r)||(t.if(n._`${l} > ${i}`,()=>e.subschema({keyword:"items",schemaProp:i,dataProp:i,strictSchema:u.strictSchema},c)),e.ok(c))})}(r)):(u.items=!0,s.alwaysValidSchema(u,r)||function(){const r=t.name("valid");t.forRange("i",0,l,s=>{e.subschema({keyword:"items",dataProp:s,dataPropType:i.Type.Num,strictSchema:u.strictSchema},r),u.allErrors||t.if(n.not(r),()=>t.break())}),e.ok(r)}())}};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(10),s=r(3),a=r(4),o={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?n.str`should contain at least ${e} valid item(s)`:n.str`should contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?n._`{minContains: ${e}}`:n._`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:o,data:c,it:u}=e;let l,d;const{minContains:h,maxContains:f}=o;u.opts.next?(l=void 0===h?1:h,d=f):l=1;const p=t.const("len",n._`${c}.length`);if(e.setParams({min:l,max:d}),void 0===d&&0===l)return void a.checkStrictMode(u,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==d&&l>d)return a.checkStrictMode(u,'"minContains" > "maxContains" is always invalid'),void e.fail();if(s.alwaysValidSchema(u,r)){let t=n._`${p} >= ${l}`;return void 0!==d&&(t=n._`${t} && ${p} <= ${d}`),void e.pass(t)}u.items=!0;const m=t.name("valid");if(void 0===d&&1===l)v(m,()=>t.if(m,()=>t.break()));else{t.let(m,!1);const e=t.name("_valid"),r=t.let("count",0);v(e,()=>t.if(e,()=>function(e){t.code(n._`${e}++`),void 0===d?t.if(n._`${e} >= ${l}`,()=>t.assign(m,!0).break()):(t.if(n._`${e} > ${d}`,()=>t.assign(m,!1).break()),1===l?t.assign(m,!0):t.if(n._`${e} >= ${l}`,()=>t.assign(m,!0)))}(r)))}function v(r,n){t.forRange("i",0,p,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:i.Type.Num,compositeRule:!0},r),n()})}e.result(m,()=>e.reset())}};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const n=r(1),i=r(3),s=r(8);t.error={message:({params:{property:e,depsCount:t,deps:r}})=>{const i=1===t?"property":"properties";return n.str`should have ${i} ${r} when property ${e} is present`},params:({params:{property:e,depsCount:t,deps:r,missingProperty:i}})=>n._`{property: ${e},
    missingProperty: ${i},
    depsCount: ${t},
    deps: ${r}}`};const a={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e){if("__proto__"===n)continue;(Array.isArray(e[n])?t:r)[n]=e[n]}return[t,r]}(e);o(e,t),c(e,r)}};function o(e,t=e.schema){const{gen:r,data:i,it:a}=e;if(0===Object.keys(t).length)return;const o=r.let("missing");for(const c in t){const u=t[c];if(0===u.length)continue;const l=s.propertyInData(i,c,a.opts.ownProperties);e.setParams({property:c,depsCount:u.length,deps:u.join(", ")}),a.allErrors?r.if(l,()=>{for(const t of u)s.checkReportMissingProp(e,t)}):(r.if(n._`${l} && (${s.checkMissingProp(e,u,o)})`),s.reportMissingProp(e,o),r.else())}}function c(e,t=e.schema){const{gen:r,data:n,keyword:a,it:o}=e,c=r.name("valid");for(const u in t)i.alwaysValidSchema(o,t[u])||(r.if(s.propertyInData(n,u,o.opts.ownProperties),()=>{const t=e.subschema({keyword:a,schemaProp:u},c);e.mergeValidEvaluated(t,c)},()=>r.var(c,!0)),e.ok(c))}t.validatePropertyDeps=o,t.validateSchemaDeps=c,t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(3),s={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:({params:e})=>n.str`property name '${e.propertyName}' is invalid`,params:({params:e})=>n._`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:s,it:a}=e;if(i.alwaysValidSchema(a,r))return;const o=t.name("valid");t.forIn("key",s,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0,strictSchema:a.strictSchema},o),t.if(n.not(o),()=>{e.error(!0),a.allErrors||t.break()})}),e.ok(o)}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(18),i=r(8),s=r(3),a=r(32),o={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:o,data:c,it:u}=e;"all"===u.opts.removeAdditional&&void 0===o.additionalProperties&&a.default.code(new n.default(u,a.default,"additionalProperties"));const l=i.allSchemaProperties(r);u.opts.unevaluated&&l.length&&!0!==u.props&&(u.props=s.mergeEvaluated.props(t,s.toHash(l),u.props));const d=l.filter(e=>!s.alwaysValidSchema(u,r[e]));if(0===d.length)return;const h=t.name("valid");for(const r of d)f(r)?p(r):(t.if(i.propertyInData(c,r,u.opts.ownProperties)),p(r),u.allErrors||t.else().var(h,!0),t.endIf()),e.ok(h);function f(e){return u.opts.useDefaults&&!u.compositeRule&&void 0!==r[e].default}function p(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t,strictSchema:u.strictSchema},h)}}};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8),i=r(1),s=r(10),a=r(4),o=r(3),c={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:c,parentSchema:u,it:l}=e,{opts:d}=l,h=n.schemaProperties(l,r);if(0===h.length)return;const f=d.strict&&!d.allowMatchingProperties&&u.properties,p=t.name("valid");!0===l.props||l.props instanceof i.Name||(l.props=o.evaluatedPropsToName(t,l.props));const{props:m}=l;function v(e){for(const t in f)new RegExp(e).test(t)&&a.checkStrictMode(l,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function g(r){t.forIn("key",c,a=>{t.if(i._`${n.usePattern(t,r)}.test(${a})`,()=>{e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:a,dataPropType:s.Type.Str,strictSchema:l.strictSchema},p),l.opts.unevaluated&&!0!==m?t.assign(i._`${m}[${a}]`,!0):l.allErrors||t.if(i.not(p),()=>t.break())})})}!function(){for(const e of h)f&&v(e),l.allErrors?g(e):(t.var(p,!0),g(e),t.if(p))}()}};t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),i={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:i}=e;if(n.alwaysValidSchema(i,r))return void e.fail();const s=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.result(s,()=>e.error(),()=>e.reset())},error:{message:"should NOT be valid"}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(3),s={keyword:"anyOf",schemaType:"array",trackErrors:!0,code(e){const{gen:t,schema:r,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(e=>i.alwaysValidSchema(s,e))&&!s.opts.unevaluated)return;const a=t.let("valid",!1),o=t.name("_valid");t.block(()=>r.forEach((r,i)=>{const s=e.subschema({keyword:"anyOf",schemaProp:i,compositeRule:!0},o);t.assign(a,n._`${a} || ${o}`);e.mergeValidEvaluated(s,o)||t.if(n.not(a))})),e.result(a,()=>e.reset(),()=>e.error(!0))},error:{message:"should match some schema in anyOf"}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(3),s={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"should match exactly one schema in oneOf",params:({params:e})=>n._`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const a=r,o=t.let("valid",!1),c=t.let("passing",null),u=t.name("_valid");e.setParams({passing:c}),t.block((function(){a.forEach((r,a)=>{let l;i.alwaysValidSchema(s,r)?t.var(u,!0):l=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},u),a>0&&t.if(n._`${u} && ${o}`).assign(o,!1).assign(c,n._`[${c}, ${a}]`).else(),t.if(u,()=>{t.assign(o,!0),t.assign(c,a),l&&e.mergeEvaluated(l,n.Name)})})})),e.result(o,()=>e.reset(),()=>e.error(!0))}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),i={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:i}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=t.name("valid");r.forEach((t,r)=>{if(n.alwaysValidSchema(i,t))return;const a=e.subschema({keyword:"allOf",schemaProp:r},s);e.ok(s),e.mergeEvaluated(a)})}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i=r(3),s=r(4),a={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>n.str`should match "${e.ifClause}" schema`,params:({params:e})=>n._`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:i}=e;void 0===r.then&&void 0===r.else&&s.checkStrictMode(i,'"if" without "then" and "else" is ignored');const a=o(i,"then"),c=o(i,"else");if(!a&&!c)return;const u=t.let("valid",!0),l=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},l);e.mergeEvaluated(t)}(),e.reset(),a&&c){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(l,d("then",r),d("else",r))}else a?t.if(l,d("then")):t.if(n.not(l),d("else"));function d(r,i){return()=>{const s=e.subschema({keyword:r},l);t.assign(u,l),e.mergeValidEvaluated(s,u),i?t.assign(i,n._`${r}`):e.setParams({ifClause:r})}}e.pass(u,()=>e.error(!0))}};function o(e,t){const r=e.schema[t];return void 0!==r&&!i.alwaysValidSchema(e,r)}t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4),i={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&n.checkStrictMode(r,`"${e}" without "if" is ignored`)}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=[r(74).default];t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),i={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>n.str`should match format "${e}"`,params:({schemaCode:e})=>n._`{format: ${e}}`},code(e,t){const{gen:r,data:i,$data:s,schema:a,schemaCode:o,it:c}=e,{opts:u,errSchemaPath:l,schemaEnv:d,self:h}=c;u.validateFormats&&(s?function(){const s=r.scopeValue("formats",{ref:h.formats,code:u.code.formats}),a=r.const("fDef",n._`${s}[${o}]`),c=r.let("fType"),l=r.let("format");r.if(n._`typeof ${a} == "object" && !(${a} instanceof RegExp)`,()=>r.assign(c,n._`${a}.type || "string"`).assign(l,n._`${a}.validate`),()=>r.assign(c,n._`"string"`).assign(l,a)),e.fail$data(n.or(!1===u.strict?n.nil:n._`${o} && !${l}`,function(){const e=d.$async?n._`(${a}.async ? await ${l}(${i}) : ${l}(${i}))`:n._`${l}(${i})`,r=n._`(typeof ${l} == "function" ? ${e} : ${l}.test(${i}))`;return n._`${l} && ${l} !== true && ${c} === ${t} && !${r}`}()))}():function(){const s=h.formats[a];if(!s)return void function(){if(!1===u.strict)return void h.logger.warn(e());throw new Error(e());function e(){return`unknown format "${a}" ignored in schema at path "${l}"`}}();if(!0===s)return;const[o,c,f]=function(e){const t=r.scopeValue("formats",{key:a,ref:e,code:u.code.formats?n._`${u.code.formats}${n.getProperty(a)}`:void 0});if("object"==typeof e&&!(e instanceof RegExp))return[e.type||"string",e.validate,n._`${t}.validate`];return["string",e,t]}(s);o===t&&e.pass(function(){if("object"==typeof s&&!(s instanceof RegExp)&&s.async){if(!d.$async)throw new Error("async format in sync schema");return n._`await ${f}(${i})`}return"function"==typeof c?n._`${f}(${i})`:n._`${f}.test(${i})`}())}())}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},function(e,t,r){"use strict";r.r(t);var n=r(25);window.addEventListener("DOMContentLoaded",()=>{if(!window.AudioContext){const e="Web Audio not supported, change your browser";throw alert(e),new Error(e)}(new n.App).run()})}]);